WITH EQ_TABLE AS ( SELECT a.cob_date,A.ccc_business_area, CASE when A.CCC_TAPS_COMPANY in ( '0201','0103','0205','0206','0530','5924') then 'MSCO' when A.CCC_TAPS_COMPANY in ('0111') then 'MSCS' when A.CCC_TAPS_COMPANY in ('0105', '0513', '1133', '1614', '2042', '4442', '4919', '4920', '5122', '6399', '7025', '7038', '7114', '7323', '7410', '7504', '7516', '8296', '8304', '8562', '8747', '8934', '7706', '7549', '6706', '5427', '7414', '7465', '7493', '7278', '7279', '7705', '7624', '7681', '7800', '5656', '7708', '7707', '7801', '7627', '7759', '7710', '7762', '7630', '7628', '7761', '7684', '5923', '7609') then 'MSCGI' when A.CCC_TAPS_COMPANY in ('5745') then 'MSCAP' when A.CCC_TAPS_COMPANY in ('0146') then 'MSDP' ELSE a.CCC_TAPS_COMPANY END AS LE, a.DIVISION, a.ISSUE_ID_DECOMP, SUM (COALESCE (a.USD_EQ_DELTA_DECOMP,0)) AS DELTA FROM CDWUSER.U_DECOMP_MSR a WHERE A.COB_DATE IN ('03/31/2017','04/28/2017','05/31/2017','06/30/2017','07/31/2017','08/31/2017','09/29/2017','10/31/2017','11/30/2017','12/29/2017','01/31/2018','02/28/2018') AND a.DIVISION = 'IED' AND a.CCC_BANKING_TRADING IN ('TRADING') AND A.CCC_TAPS_COMPANY IN ( '0201','0103','0205','0206','0530','5924','0111','5745') GROUP BY a.cob_date,A.ccc_business_area, CASE when A.CCC_TAPS_COMPANY in ( '0201','0103','0205','0206','0530','5924') then 'MSCO' when A.CCC_TAPS_COMPANY in ('0111') then 'MSCS' when A.CCC_TAPS_COMPANY in ('0105', '0513', '1133', '1614', '2042', '4442', '4919', '4920', '5122', '6399', '7025', '7038', '7114', '7323', '7410', '7504', '7516', '8296', '8304', '8562', '8747', '8934', '7706', '7549', '6706', '5427', '7414', '7465', '7493', '7278', '7279', '7705', '7624', '7681', '7800', '5656', '7708', '7707', '7801', '7627', '7759', '7710', '7762', '7630', '7628', '7761', '7684', '5923', '7609') then 'MSCGI' when A.CCC_TAPS_COMPANY in ('5745') then 'MSCAP' when A.CCC_TAPS_COMPANY in ('0146') then 'MSDP' ELSE a.CCC_TAPS_COMPANY END, a.DIVISION, a.ISSUE_ID_DECOMP ) SELECT cob_date, LE, DIVISION, ccc_business_area, round(SUM (ABS (DELTA)),2) AS GROSS_DELTA FROM EQ_TABLE GROUP BY cob_date, LE, DIVISION, ccc_business_area UNION SELECT cob_date, LE, DIVISION, 'null' as ccc_business_area, round(SUM (ABS (DELTA)),2) AS GROSS_DELTA FROM EQ_TABLE GROUP BY cob_date, LE, DIVISION, ccc_business_area