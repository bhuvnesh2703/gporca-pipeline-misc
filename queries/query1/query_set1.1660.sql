SELECT a.ATTRIBUTE9 AS "Risk metric", a.ATTRIBUTE10 AS "Unit", SUM(a.VALUE1)/1000 AS "Current (ISG)", coalesce(prior_risk_all,0) AS "Prior (ISG)", (SUM(a.VALUE1)/1000 - coalesce(prior_risk_all,0)) AS "Change (ISG)", coalesce(current_risk_fid,0) AS "Current (FID)", coalesce(prior_risk_fid,0) AS "Prior (FID)", (coalesce(current_risk_fid,0) - coalesce(prior_risk_fid,0)) AS "Change (FID)", coalesce(current_risk_ied,0) AS "Current (IED)", coalesce(prior_risk_ied,0) AS "Prior (IED)", (coalesce(current_risk_ied,0) - coalesce(prior_risk_ied,0)) AS "Change (IED)", (SUM(a.VALUE1)/1000 - coalesce(current_risk_fid,0) - coalesce(current_risk_ied,0)) AS "Current (Others)", (coalesce(prior_risk_all,0) - coalesce(prior_risk_fid,0) - coalesce(prior_risk_ied,0)) AS "Prior (Others)", ((SUM(a.VALUE1)/1000 - coalesce(current_risk_fid,0) - coalesce(current_risk_ied,0))) - ((coalesce(prior_risk_all,0) - coalesce(prior_risk_fid,0) - coalesce(prior_risk_ied,0))) AS "Change (Others)" from CDWUSER.U_GENERIC_DATA a LEFT JOIN (SELECT ATTRIBUTE9, ATTRIBUTE10, SUM(VALUE1)/1000 AS prior_risk_fid from CDWUSER.U_GENERIC_DATA where cob_date IN ('2018-01-19') and analytic_group = 'FDSF' and analytics = 'SENSITIVITIES' and ATTRIBUTE3 IN ('FIXED INCOME DIVISION') and ATTRIBUTE1 IN ('FX') group by ATTRIBUTE9,ATTRIBUTE10) b ON (a.ATTRIBUTE9=b.ATTRIBUTE9 AND a.ATTRIBUTE10=b.ATTRIBUTE10) LEFT JOIN (SELECT ATTRIBUTE9, ATTRIBUTE10, SUM(VALUE1)/1000 AS current_risk_fid from CDWUSER.U_GENERIC_DATA where cob_date IN ('2018-02-16') and analytic_group = 'FDSF' and analytics = 'SENSITIVITIES' and ATTRIBUTE3 IN ('FIXED INCOME DIVISION') and ATTRIBUTE1 IN ('FX') group by ATTRIBUTE9,ATTRIBUTE10) c on (b.ATTRIBUTE9=c.ATTRIBUTE9 AND b.ATTRIBUTE10=c.ATTRIBUTE10) LEFT JOIN (SELECT ATTRIBUTE9, ATTRIBUTE10, SUM(VALUE1)/1000 AS prior_risk_all from CDWUSER.U_GENERIC_DATA where cob_date IN ('2018-01-19') and analytic_group = 'FDSF' and analytics = 'SENSITIVITIES' and ATTRIBUTE1 IN ('FX') group by ATTRIBUTE9,ATTRIBUTE10) d on (c.ATTRIBUTE9=d.ATTRIBUTE9 AND c.ATTRIBUTE10=d.ATTRIBUTE10) LEFT JOIN (SELECT ATTRIBUTE9, ATTRIBUTE10, SUM(VALUE1)/1000 AS prior_risk_ied from CDWUSER.U_GENERIC_DATA where cob_date IN ('2018-01-19') and analytic_group = 'FDSF' and analytics = 'SENSITIVITIES' and ATTRIBUTE3 IN ('INSTITUTIONAL EQUITY DIVISION') and ATTRIBUTE1 IN ('FX') group by ATTRIBUTE9,ATTRIBUTE10) e ON (a.ATTRIBUTE9=e.ATTRIBUTE9 AND a.ATTRIBUTE10=e.ATTRIBUTE10) LEFT JOIN (SELECT ATTRIBUTE9, ATTRIBUTE10, SUM(VALUE1)/1000 AS current_risk_ied from CDWUSER.U_GENERIC_DATA where cob_date IN ('2018-02-16') and analytic_group = 'FDSF' and analytics = 'SENSITIVITIES' and ATTRIBUTE3 IN ('INSTITUTIONAL EQUITY DIVISION') and ATTRIBUTE1 IN ('FX') group by ATTRIBUTE9,ATTRIBUTE10) f on (a.ATTRIBUTE9=f.ATTRIBUTE9 AND a.ATTRIBUTE10=f.ATTRIBUTE10) where cob_date IN ('2018-02-16') and analytic_group = 'FDSF' and analytics = 'SENSITIVITIES' and a.ATTRIBUTE1 IN ('FX') group by a.ATTRIBUTE9,a.ATTRIBUTE10, current_risk_fid, prior_risk_fid, prior_risk_all, current_risk_ied, prior_risk_ied order by a.ATTRIBUTE9