select base_currency_combined, risk_currency_combined, currency_pair,book, sum(SLIDE_FXOPTVAR_MIN_20PCT_USD) as neg20, sum(SLIDE_FXOPTVAR_MIN_10PCT_USD) as neg10, sum(SLIDE_FXOPTVAR_MIN_05PCT_USD) as neg5, sum(SLIDE_FXOPTVAR_MIN_03PCT_USD) as neg3, sum(SLIDE_FXOPTVAR_MIN_01PCT_USD) as neg1, sum(SLIDE_FXOPTVAR_MIN_0P5PCT_USD) as neg05, sum(SLIDE_FXOPTVAR_PLS_0P5PCT_USD) as pos05, sum(SLIDE_FXOPTVAR_PLS_01PCT_USD) as pos1, sum(SLIDE_FXOPTVAR_PLS_03PCT_USD) as pos3, sum(SLIDE_FXOPTVAR_PLS_05PCT_USD) as pos5, sum(SLIDE_FXOPTVAR_PLS_10PCT_USD) as pos10, sum(SLIDE_FXOPTVAR_PLS_20PCT_USD) as pos20, ccc_pl_reporting_region, 0 as base, case when risk_currency_combined = 'UNDEFINED' and base_currency_combined <> 'UNDEFINED' then base_currency_combined else risk_currency_combined end as COMB, case when substr(currency_pair,1,3) = 'CNH' then concat('CNY' ,substr(currency_pair,length(currency_pair)-2,3) ) when substr(currency_pair,length(currency_pair)-2,3) ='CNH' then concat(substr(currency_pair,1,3) , 'CNY') when substr(currency_pair,1,3) = 'RBX' then concat('RUB' , substr(currency_pair,length(currency_pair)-2,3) ) when substr(currency_pair,length(currency_pair)-2,3) ='RBX' then concat(substr(currency_pair,1,3) ,'RUB' ) when substr(currency_pair,1,3) = 'BRX' then concat('BRL' , substr(currency_pair,length(currency_pair)-2,3) ) when substr(currency_pair,length(currency_pair)-2,3) = 'BRX' then concat(substr(currency_pair,1,3) , 'BRL' ) when substr(currency_pair,1,3) = 'BR1' then concat('BRL' , substr(currency_pair,length(currency_pair)-2,3) ) when substr(currency_pair,length(currency_pair)-2,3) = 'BR1' then concat(substr(currency_pair,1,3) , 'BRL' ) when substr(currency_pair,1,3) = 'UBD' then concat('USD' , substr(currency_pair,length(currency_pair)-2,3) ) when substr(currency_pair,length(currency_pair)-2,3) = 'UBD' then concat(substr(currency_pair,1,3) , 'USD' ) else currency_pair end as new_ccy_pair, CASE When currency_pair NOT like '%NZD%' and currency_pair NOT like '%CHF%' and currency_pair NOT like '%SEK%' and currency_pair NOT like '%EUR%' and currency_pair NOT like '%NOK%' and currency_pair NOT like '%CAD%' and currency_pair NOT like '%AUD%' and currency_pair NOT like '%JPY%' and currency_pair NOT like '%GBP%' and currency_pair NOT like '%USD%' and currency_pair NOT like '%UBD%' then 'EM-EM' when currency_pair like '%USD%' OR currency_pair like '%UBD%' then 'Dollar Cross' when currency_pair like '%KRW%' or currency_pair like '%TWD%' or currency_pair like '%MYR%' or currency_pair like '%IDR%' or currency_pair like '%PHP%' or currency_pair like '%INR%' or currency_pair like '%SGD%' or currency_pair like '%HKD%' or currency_pair like '%CNY%' or currency_pair like '%THB%' or currency_pair like '%TRY%' or currency_pair like '%ZAR%' or currency_pair like '%RUB%' or currency_pair like '%ILS%' or currency_pair like '%MXN%' or currency_pair like '%CLP%' or currency_pair like '%COP%' or currency_pair like '%BRL%' then 'EM-G10' else 'G10- G10' end as group, case when ccc_pl_reporting_region = 'EMEA' then 'EMEA' else 'Other' end as region from CDWUSER.U_DM_FX a where COB_DATE in ('2018-02-28') and ccc_division in ('FIXED INCOME DIVISION') AND CCC_business_area in ('FXEM MACRO TRADING','EM CREDIT TRADING') and ccc_pl_reporting_region = 'EMEA' group by ccc_pl_reporting_region, case when risk_currency_combined = 'UNDEFINED' and base_currency_combined <> 'UNDEFINED' then base_currency_combined else risk_currency_combined end, base_currency_combined, risk_currency_combined, currency_pair,book