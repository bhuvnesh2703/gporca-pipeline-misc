SELECT  PRODUCT_TYPE,             source_scn_name,SUM(M_PNL_current) FROM      (SELECT         PRODUCT_SUBTYPE,         PRODUCT_TYPE,         book,         SOURCE_SCN_NAME,         ccc_strategy,        SUM( case when strpos(source_scn_name,'50PCT') > 0 then RAW_PNL*2 else RAW_PNL end)  as M_PNL_current     from DWUSER.U_RAW_SCENARIO_PNL a      WHERE cob_date = '2018-02-28' and         (PRODUCT_SUBTYPE like '%MPE%' or PRODUCT_SUBTYPE like '%MNE%') AND         source_scn_name  in ( 'CESTRESS_Z2WK_USD_IR_UP3SD','CESTRESS_Z2WK_USD_IR_DOWN3SD', 'CESTRESS_Z2WK_EUR_FX_UP3SD','CESTRESS_Z2WK_EUR_FX_DOWN3SD', 'CESTRESS_Z2WK_EUR_IR_UP3SD','CESTRESS_Z2WK_EUR_IR_DOWN3SD', 'CESTRESS_Z2WK_JPY_FX_UP3SD','CESTRESS_Z2WK_JPY_FX_DOWN3SD', 'CESTRESS_Z2WK_GBP_FX_UP3SD','CESTRESS_Z2WK_GBP_FX_DOWN3SD', 'CESTRESS_Z2WK_GBP_IR_UP3SD','CESTRESS_Z2WK_GBP_IR_DOWN3SD', 'CESTRESS_Z2WK_US_EQ_UP3SD', 'CESTRESS_Z2WK_CNY_FX_UP3SD', 'CESTRESS_Z2WK_CHF_FX_UP3SD', 'CESTRESS_Z2WK_TRY_FX_UP3SD' ,'CESTRESS_Z2WK_CR_DOWN50PCT' ,'CESTRESS_Z2WK_CR_UP50PCT', '_UP3SD', '_UP3SD', '_UP3SD', '_UP3SD', '_UP3SD', '_UP3SD', '_UP3SD', '_UP3SD', '_UP3SD', '_UP3SD' )       GROUP BY         PRODUCT_SUBTYPE,         PRODUCT_TYPE,         SOURCE_SCN_NAME,         COB_DATE,         book,         ccc_strategy ) t Group by product_type, source_scn_name