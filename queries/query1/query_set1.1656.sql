SELECT a.COB_DATE, a.ATTRIBUTE9, a.ATTRIBUTE10, CASE WHEN a.ATTRIBUTE18 in ('3M','6M','12M','2Y') THEN '<3 yrs' WHEN a.ATTRIBUTE18 in ('3Y','5Y','7Y','10Y') THEN '3-10 yrs' ELSE '>10 yrs' END AS TENOR, CASE WHEN a.ATTRIBUTE13 in ('A / A2 / A','AA / Aa2 / AA','AAA / Aaa / AAA') THEN 'AAA to A-' WHEN a.ATTRIBUTE13 in ('B / B2 / B','BB / Ba2 / BB','BBB / Baa2 / BBB') THEN 'BBB+ to B-' WHEN a.ATTRIBUTE13 in ('C / C / C','CC / Ca / CC','CCC / Caa2 / CCC') THEN 'CCC+ to C-' WHEN a.ATTRIBUTE13 in ('Default','NR') THEN 'Default/NR' ELSE 'NULL' END AS RATING, sum(coalesce(a.VALUE1,0)) as VALUE1 FROM CDWUSER.U_GENERIC_DATA a WHERE a.ANALYTIC_GROUP = 'FDSF' AND a.COB_DATE IN ('2018-02-16') AND a.ATTRIBUTE1 = 'CR' AND ATTRIBUTE9 in ('CR Vega','CR Recovery','CR Notional','CR Market Value','CR JTD','CR Delta','CR Base Corr') AND ANALYTICS = 'SENSITIVITIES' GROUP BY a.COB_DATE, a.ATTRIBUTE9, a.ATTRIBUTE10, CASE WHEN a.ATTRIBUTE18 in ('3M','6M','12M','2Y') THEN '<3 yrs' WHEN a.ATTRIBUTE18 in ('3Y','5Y','7Y','10Y') THEN '3-10 yrs' ELSE '>10 yrs' END, CASE WHEN a.ATTRIBUTE13 in ('A / A2 / A','AA / Aa2 / AA','AAA / Aaa / AAA') THEN 'AAA to A-' WHEN a.ATTRIBUTE13 in ('B / B2 / B','BB / Ba2 / BB','BBB / Baa2 / BBB') THEN 'BBB+ to B-' WHEN a.ATTRIBUTE13 in ('C / C / C','CC / Ca / CC','CCC / Caa2 / CCC') THEN 'CCC+ to C-' WHEN a.ATTRIBUTE13 in ('Default','NR') THEN 'Default/NR' ELSE 'NULL' END