select A.POSITION_ULT_ISSUER_PARTY_DARWIN_NAME, sum(case when A.COB_DATE = '2018-02-28' then A.USD_EXPOSURE else 0 end) as NE, sum(case when A.COB_DATE = '2018-02-28' then A.USD_EXPOSURE else -A.USD_EXPOSURE end) as Nechng, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='HONG KONG') then A.USD_EXPOSURE else 0 end) as NEHK, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='PARIS') then A.USD_EXPOSURE else 0 end) as NEPARIS, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='TOKYO') then A.USD_EXPOSURE else 0 end) as NETOKYO, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='SYDNEY') then A.USD_EXPOSURE else 0 end) as NESYDNEY, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='SINGAPORE') then A.USD_EXPOSURE else 0 end) as NESINGAPORE, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='NEW YORK') then A.USD_EXPOSURE else 0 end) as NENY, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='ISTANBUL') then A.USD_EXPOSURE else 0 end) as NEISTANBUL, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='BEIJING') then A.USD_EXPOSURE else 0 end) as NEBEIJING, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='MOSCOW') then A.USD_EXPOSURE else 0 end) as NEMoscow, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='SEOUL') then A.USD_EXPOSURE else 0 end) as NESeoul, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='MEXICO CITY') then A.USD_EXPOSURE else 0 end) as NEMEXCity, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='SAO PAULO') then A.USD_EXPOSURE else 0 end) as NESPAULO FROM CDWUSER.U_EXP_MSR A WHERE A.cob_date in ('2018-02-28', '2018-01-31') and FID1_SENIORITY IN ('AT1', 'SUBT1', 'SUBUT2') AND A.USD_EXPOSURE IS NOT NULL AND ccc_banking_trading='TRADING' AND parent_legal_entity = '0302(G)' and A.POSITION_ULT_ISSUER_PARTY_DARWIN_NAME <>'UNDEFINED' and CCC_DIVISION in ('COMMODITIES','FIXED INCOME DIVISION','NON CORE') AND a.RISK_MANAGER_LOCATION <> 'LONDON' group by A.POSITION_ULT_ISSUER_PARTY_DARWIN_NAME order by SUM (case when A.COB_DATE = '2018-02-28' then abs(A.USD_EXPOSURE) else 0 end) desc