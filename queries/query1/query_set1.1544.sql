With x as ( SELECT a.CCC_PL_REPORTING_REGION as ID, a.COB_DATE, a.CCC_PL_REPORTING_REGION as REGION, ROUND(sum(coalesce(a.YTD_PL,0))/1000000,2) as YTD_PNL, ROUND(sum(coalesce(a.DAILY_PL,0))/1000000,2) as DAILY_PNL FROM CDWUSER.U_PCT_PNL_CURRENT a WHERE a.COB_DATE >= '2016-01-01' AND a.CCC_DIVISION = 'INSTITUTIONAL EQUITY DIVISION' AND (a.ACCOUNT_PURPOSE_CODE <> 'J' or a.ACCOUNT_PURPOSE_CODE is null) GROUP BY a.CCC_PL_REPORTING_REGION, a.COB_DATE, a.CCC_PL_REPORTING_REGION ), y as ( SELECT LEVEL1 as ID, a.COB_DATE, LEVEL1 as REGION, ROUND(VALUE/1000000,2) AS GNURAMV FROM CDWUSER.U_AGGREGATION_DETAIL a, CDWUSER.U_AGGREGATION_SCHEMA s WHERE a.COB_DATE >= '2016-01-01' AND a.HIERARCHY_ID = 2 AND a.LEVEL1 IS NOT NULL AND a.LEVEL2 IS NULL AND a.COB_DATE = s.COB_DATE AND a.AGGREGATION_NAME = s.AGGREGATION_NAME AND a.HIERARCHY_ID = s.HIERARCHY_ID AND a.VERSION_ID = s.VERSION_ID AND s.IS_LATEST = 1 GROUP BY LEVEL1, a.COB_DATE, Value ), z as ( SELECT v.level1 as ID, level1, cob_date, -ROUND(var05/1000,2) as VAR05, -ROUND(var01/1000,2) as VAR01, ROUND(STDDEV/1000,2) as STDDEV FROM CDWUSER.U_VAR_ID_FLAT_VIEW v WHERE (hierarchy_group_name='EQUITY_CV') AND (hierarchy_name='region') AND v.LEVEL2 IS NULL AND COB_DATE >= '2016-01-01' AND -var05 > 20 ORDER BY v.level1, cob_date, hierarchy_group_name, hierarchy_name, COALESCE(LEVEL1,''), COALESCE(LEVEL2,'') ) SELECT x.COB_DATE, x.REGION, x.YTD_PNL, x.DAILY_PNL, y.GNURAMV, z.VAR01, z.VAR05, z.STDDEV FROM x join y ON x.ID = y.ID and x.cob_date = y.cob_date join z ON x.ID = z.ID and x.cob_date = z.cob_date