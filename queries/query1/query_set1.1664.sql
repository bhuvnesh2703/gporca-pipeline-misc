SELECT a.ATTRIBUTE1 AS "Asset Class", a.ATTRIBUTE9 AS "Risk Metric", a.ATTRIBUTE10 AS "Unit of Measurement", SUM(VALUE1)/1000 AS "Current", coalesce(prior_risk,0) AS "Prior", (SUM(VALUE1)/1000 - coalesce(prior_risk,0)) AS "Change" from CDWUSER.U_GENERIC_DATA a FULL JOIN (SELECT ATTRIBUTE1, ATTRIBUTE9, ATTRIBUTE10, SUM(VALUE1)/1000 AS prior_risk from CDWUSER.U_GENERIC_DATA where cob_date IN ('2018-01-19') and analytic_group = 'FDSF' and analytics = 'SENSITIVITIES' and concat(ATTRIBUTE9,ATTRIBUTE10) IN ('IR Delta+1bp', 'IR Vega+10% rel:Ln', 'IF Vega+10% rel:SABR', 'FX Delta+1%', 'FX Vega+1% abs:Ln', 'CR Delta+1bp', 'CR Delta+10%', 'CR Vega+1%abs:Ln', 'EQ Delta+1%', 'EQ Vega+1% abs:Ln', 'EQ Divs+1% rel', 'CM Delta+1%', 'CM Vega+1% rel:Ln', 'CM Vega+1% abs:Ln') group by ATTRIBUTE1,ATTRIBUTE9,ATTRIBUTE10) b on (a.ATTRIBUTE1=b.ATTRIBUTE1 AND a.ATTRIBUTE9=b.ATTRIBUTE9 AND a.ATTRIBUTE10=b.ATTRIBUTE10) where cob_date IN ('2018-02-16') and a.analytic_group = 'FDSF' and a.analytics = 'SENSITIVITIES' and concat(a.ATTRIBUTE9,a.ATTRIBUTE10) IN ('IR Delta+1bp', 'IR Vega+10% rel:Ln', 'IF Vega+10% rel:SABR', 'FX Delta+1%', 'FX Vega+1% abs:Ln', 'CR Delta+1bp', 'CR Delta+10%', 'CR Vega+1%abs:Ln', 'EQ Delta+1%', 'EQ Vega+1% abs:Ln', 'EQ Divs+1% rel', 'CM Delta+1%', 'CM Vega+1% rel:Ln', 'CM Vega+1% abs:Ln') group by a.ATTRIBUTE1,a.ATTRIBUTE9,a.ATTRIBUTE10,prior_risk order by a.ATTRIBUTE1,a.ATTRIBUTE9,a.ATTRIBUTE10 asc