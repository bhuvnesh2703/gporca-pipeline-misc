SELECT a.COB_DATE ,a.PARENT_LEGAL_ENTITY , a.ctpy_netting_group_code , a.POSITION_CREDIT_PARTY_DARWIN_NAME , 0 as rank ,sum(A.USD_PV01SPRD) as USD_PV01SPRD FROM OERUSER.U_EXP_MSR a WHERE a.COB_DATE in ('2018-02-28') AND a.PARENT_LEGAL_ENTITY in ('0201(G)') and a.POSITION_CREDIT_PARTY_DARWIN_NAME in( 'CHICAGO MERCANTILE EXCHANGE INC.', 'ICE CLEAR CREDIT LLC', 'MORGAN STANLEY & CO. INTERNATIONAL PLC', 'MORGAN STANLEY CAPITAL SERVICES LLC', 'N/A' ) GROUP BY a.COB_DATE ,a.PARENT_LEGAL_ENTITY ,a.ctpy_netting_group_code ,a.POSITION_CREDIT_PARTY_DARWIN_NAME UNION SELECT a.COB_DATE ,a.PARENT_LEGAL_ENTITY , a.ctpy_netting_group_code ,a.POSITION_CREDIT_PARTY_DARWIN_NAME ,rank() OVER (ORDER BY abs(sum(A.USD_PV01SPRD)) DESC) AS rank ,sum(A.USD_PV01SPRD) as USD_PV01SPRD FROM OERUSER.U_EXP_MSR a WHERE a.COB_DATE in ('2018-02-28') AND a.PARENT_LEGAL_ENTITY in ('0201(G)') and a.POSITION_CREDIT_PARTY_DARWIN_NAME not in( 'CHICAGO MERCANTILE EXCHANGE INC.', 'ICE CLEAR CREDIT LLC', 'MORGAN STANLEY & CO. INTERNATIONAL PLC', 'MORGAN STANLEY CAPITAL SERVICES LLC', 'N/A' ) and a.USD_PV01SPRD is not null GROUP BY a.COB_DATE ,a.PARENT_LEGAL_ENTITY ,a.ctpy_netting_group_code ,a.POSITION_CREDIT_PARTY_DARWIN_NAME