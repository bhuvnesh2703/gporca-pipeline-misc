Select COB_DATE,CCC_PL_REPORTING_REGION, prod_pos_name_description, TIME_BUCKET_ANNUAL,SUM (DOLLAR_GREEK) as DOLLAR_GREEK FROM (select a.prod_pos_name_description, TIME_BUCKET_ANNUAL, CCC_PRODUCT_LINE,product_sub_type_code, product_type_code, CMDTY_CD,EXPIRATION_DATE,time_bucket_quarter, product_sub_type_name,COB_DATE,CCC_BUSINESS_AREA,TIME_BUCKET_CALENDAR,CCC_PL_REPORTING_REGION, sum(cast(a.usd_fx as numeric(15,5))) as RAW_GREEK, Sum(cast(USD_FX_Delta as numeric(15,5))) as DOLLAR_GREEK FROM cdwuser.U_FX_MSR a Where COB_DATE IN ('2018-02-28','2018-01-31') AND ((CCC_DIVISION='COMMODITIES' AND CCC_BUSINESS_AREA not in ('CREDIT','MS CVA MNE - COMMOD', 'COMMODS FINANCING','INVESTMENTS AND STR TRANS','INVESTOR BUSINESS')) OR(CCC_DIVISION = 'FIXED INCOME DIVISION' AND CCC_BUSINESS_AREA = 'COMMODITIES' AND CCC_PRODUCT_LINE NOT IN ('COMMOD LENDING', 'COMMOD EXOTICS', 'COMMOD INDEX') AND CCC_STRATEGY NOT IN ('MS CVA MNE - COMMOD', 'CMD LEGACY LAONS & CLAIMS', 'CVA RISK MANAGEMENT', 'FVA RISK MANAGEMENT', 'FUNDING COLLATERAL COMM'))) /* NEW LOGIC*/ AND (CCC_PL_REPORTING_REGION IN ('EUROPE','EMEA')) and product_type_code in('CURRENCY','INV STR TRANS - METALS') group by prod_pos_name_description,CCC_PRODUCT_LINE,product_sub_type_code, product_type_code,product_sub_type_name, COB_DATE,CCC_PL_REPORTING_REGION, CCC_BUSINESS_AREA,TIME_BUCKET_CALENDAR,TIME_BUCKET_ANNUAL, CMDTY_CD, EXPIRATION_DATE,time_bucket_quarter) abc GROUP BY COB_DATE,prod_pos_name_description,CCC_PL_REPORTING_REGION, TIME_BUCKET_ANNUAL