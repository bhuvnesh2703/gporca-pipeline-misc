SELECT a.Cob_DATE, CASE WHEN a.PRODUCT_TYPE_CODE IN ('NATGAS') THEN 'Nat Gas' WHEN a.PRODUCT_TYPE_CODE IN ('TEXAS INTERCONNECT O', 'TEXAS INTERCONNECT P', 'WEST INTERCONNECT OF', 'WEST INTERCONNECT PE', 'EAST INTERCONNECT PE', 'EAST INTERCONNECT OF', 'GRNPWR PEAK', 'GRNPWR OFF', 'EURO PWR', 'EURO PWR SPREAD', 'EMISSIONS-EU', 'EMISSIONS-US', 'EAST OFF', 'EAST PEAK', 'MIDWEST OFF', 'MIDWEST PEAK', 'TEXAS OFF', 'TEXAS PEAK', 'WEST OFF', 'WEST PEAK') THEN 'Power' WHEN a.PRODUCT_TYPE_CODE IN ('BASEMETAL', 'PRECIOUSMETAL') THEN 'Metals' WHEN a.PRODUCT_TYPE_CODE IN ('CRUDE', 'ETHANOL', 'GAS', 'GASOLINE CREDITS', 'NAPHTHA', 'NGL') THEN 'Crude. Gasoline, Diesel' WHEN a.PRODUCT_TYPE_CODE IN ('JET', 'FUEL', 'DIST') THEN 'Distillates' else 'Other' END AS Product_Type, SUM (a.USD_CM_DELTA) AS DOLLAR_DELTA FROM cdwuser.U_EXP_TRENDS a WHERE ((a.CCC_DIVISION = 'COMMODITIES' AND a.CCC_BUSINESS_AREA NOT IN ('COMMODS FINANCING')) /* OLD LOGIC*/ OR (A.CCC_DIVISION = 'FIXED INCOME DIVISION' AND A.CCC_BUSINESS_AREA = 'COMMODITIES' and a.CCC_PRODUCT_LINE IN ('NA POWER & GAS'))) /* NEW LOGIC, NEED TO MAKE SURE THE PRODUCT LINE FILTER MAKES SENSE*/ AND a.PRODUCT_TYPE_CODE NOT IN ('CURRENCY', 'INTEREST RATE', 'INFLATION', 'TBD', 'MISC', 'CVA', 'FVA') AND a.COB_DATE IN ('2018-02-28','2018-01-31','2017-12-29','2017-09-29','2017-06-30','2017-03-31') and a.INCLUDE_IN_REG_CAAP_FL = 'N' and a.PRODUCT_SUB_TYPE_CODE in ('N EAST CONSUMPTI', 'N EAST CONSUMPTION', 'N EAST APPALACHI', 'N EAST APPALACHIA') and a.BOOK = '18003' GROUP BY a.Cob_DATE, CASE WHEN a.PRODUCT_TYPE_CODE IN ('NATGAS') THEN 'Nat Gas' WHEN a.PRODUCT_TYPE_CODE IN ('TEXAS INTERCONNECT O', 'TEXAS INTERCONNECT P', 'WEST INTERCONNECT OF', 'WEST INTERCONNECT PE', 'EAST INTERCONNECT PE', 'EAST INTERCONNECT OF', 'GRNPWR PEAK', 'GRNPWR OFF', 'EURO PWR', 'EURO PWR SPREAD', 'EMISSIONS-EU', 'EMISSIONS-US', 'EAST OFF', 'EAST PEAK', 'MIDWEST OFF', 'MIDWEST PEAK', 'TEXAS OFF', 'TEXAS PEAK', 'WEST OFF', 'WEST PEAK') THEN 'Power' WHEN a.PRODUCT_TYPE_CODE IN ('BASEMETAL', 'PRECIOUSMETAL') THEN 'Metals' WHEN a.PRODUCT_TYPE_CODE IN ('CRUDE', 'ETHANOL', 'GAS', 'GASOLINE CREDITS', 'NAPHTHA', 'NGL') THEN 'Crude. Gasoline, Diesel' WHEN a.PRODUCT_TYPE_CODE IN ('JET', 'FUEL', 'DIST') THEN 'Distillates' else 'Other' END order by a.COB_DATE