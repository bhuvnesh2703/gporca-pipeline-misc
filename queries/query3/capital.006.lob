SELECT * FROM ( SELECT rank() over(order by ABS(SUM ((a.SR_CHARGE))) desc) as rank, a.SECURITIZATION_FLAG, a.CHILD_ISSUER_ID, a.CHILD_ISSUER_NAME, a.CCC_BUSINESS_AREA, a.PRODUCT_TYPE, a.SR_MEASURE_NAME, a.LEVEL_7, a.NETTING_CATEGORY, a.sr_charge_factor, ROUND(SUM(ABS (a.SR_VALUE))) AS GROSS_EXPOSURE, ROUND(SUM((a.SR_VALUE))) AS NET_EXPOSURE, ROUND(SUM(ABS(a.SR_CHARGE))) AS GROSS_CHARGE, ROUND(ABS(SUM ((a.SR_CHARGE)))) AS NET_CHARGE, ROUND(SUM(ABS(a.SR_CHARGE))) * 12.5 AS GROSS_RWA, ROUND(ABS(SUM ((a.SR_CHARGE)))) *12.5 AS NET_RWA FROM CDWUSER.U_CAPITAL a WHERE a.cob_date = date '20180228' AND a.SR_STD_CHARGE_REQUIRED = 1 AND a.ASSET_CLASS <> 'EQ' AND a.sr_value > 10 AND a.SR_CHARGE > 10 AND a.sr_value IS NOT NULL AND a.SECURITIZATION_FLAG NOT IN ('Y', 'R', 'N') AND a.REGULATOR = 'GLOBAL' AND a.PRODUCT_TYPE not in ('MUNI','CONVRT', 'MUNI_TAXABLE','BANKDEBT') GROUP BY a.SECURITIZATION_FLAG, a.CHILD_ISSUER_ID, a.CHILD_ISSUER_NAME, a.LEVEL_7, a.CCC_BUSINESS_AREA, a.PRODUCT_TYPE, a.SR_MEASURE_NAME, a.NETTING_CATEGORY, a.sr_charge_factor ) inner_query WHERE rank <= 50