SELECT B.COB_DATE, B.PRODUCT_HIERARCHY_LEVEL7, SUM(cast(B.Notional as numeric(15,5))) AS NOTIONAL FROM ( Select COB_DATE , a.PRODUCT_HIERARCHY_LEVEL7 , a.CAPITAL_CHARGE_NETTING_KEY , ABS(sum(coalesce(a.USD_NOTIONAL,0))) Notional from cdwuser.U_EXP_MSR a where COB_DATE in ('2018-02-28') and CCC_BUSINESS_AREA in ('DSP - CREDIT') AND a.PRODUCT_HIERARCHY_LEVEL7 IN ( 'CR_BESPOKE BASKET DEFAULT SWAPS', 'CR_BESPOKE BASKET DEFAULT SWAPS', 'CR_BESPOKE SYNTHETIC CLO', 'CR_BESPOKE SYNTHETIC CLO (CANCELLABLE NAMES)', 'CR_FIRST TO DEFAULT BASKET SWAP', 'CR_FIRST_TO_DEFAULT_BASKET_SWAP_FIXED_RECOVERY', 'CR_FIXED RECOVERY BASKET DEFAULT SWAP', 'CR_FIXED RECOVERY BESPOKE SYNTHETIC CLO', 'CR_RISKY COLLATERAL FOR CDO', 'CR_RISKY COLLATERAL FOR CDO_FIXED_RECOVERY', 'CR_WRAPPED SEPARATE ACCOUNT', 'CR_BESPOKE BASKET DEFAULT SWAPS WITH EQUITY TRIGGER', 'CR_RISKY_COLLATERAL_FOR_LONG_SHORT_CDO', 'CR_MS ISSUANCE_LOSS', 'CR_CDO2', 'CR_LEVERAGED SUPER SENIOR' ) Group by COB_DATE , a.PRODUCT_HIERARCHY_LEVEL7 , a.CAPITAL_CHARGE_NETTING_KEY ) B GROUP BY B.COB_DATE, B.PRODUCT_HIERARCHY_LEVEL7