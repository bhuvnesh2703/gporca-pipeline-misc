SELECT CASE A.CURVE_NAME WHEN 'fxusdbr1' THEN 'FX' WHEN 'brlnw_spd' THEN 'IR' else 'others' END AS CURVETYPE, case when (a.VERTICAL_SYSTEM like '%EQUITY%'  and a.PRODUCT_TYPE_CODE not in ('GVTBOND','RATEFUT')) THEN 'OTHER EQ' ELSE 'OTHER FID' END AS CATEGORY ,CASE WHEN A.PRODUCT_TYPE_CODE in ('GVTBOND')   THEN ' Government Bonds' WHEN A.PRODUCT_TYPE_CODE LIKE '%RATEFUT%' THEN 'Rate Futures' else 'OTHERS' END AS PRODUCT_TYPE_CODE,  TERM_BUCKET, SUM(A.USD_IRPV01SPRD) AS FXBASIS FROM CDWUSER.U_EXP_MSR A where COB_DATE='2018-02-28' AND A.CCC_DIVISION='INSTITUTIONAL EQUITY DIVISION' AND A.CURRENCY_OF_MEASURE='BRL' AND CCC_BUSINESS_AREA NOT LIKE '%CPM%' AND A.CURVE_NAME IN ('fxusdbr1','brlnw_spd') GROUP BY CASE A.CURVE_NAME WHEN 'fxusdbr1' THEN 'FX' WHEN 'brlnw_spd' THEN 'IR' else 'others' END, TERM_BUCKET, case when (a.VERTICAL_SYSTEM like '%EQUITY%'  and a.PRODUCT_TYPE_CODE not in ('GVTBOND','RATEFUT')) THEN 'OTHER EQ' ELSE 'OTHER FID' END ,CASE WHEN A.PRODUCT_TYPE_CODE in ('GVTBOND')   THEN ' Government Bonds' WHEN A.PRODUCT_TYPE_CODE LIKE '%RATEFUT%' THEN 'Rate Futures' else 'OTHERS' END