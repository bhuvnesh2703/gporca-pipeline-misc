select COB_DATE, book, case when abs(sum(USD_IRPV01SPRD))>10 then book else 'Other Books' end as Book, case when curve_name = 'eurnw_disc' then 'EUR 3sFF' when curve_name in ('usdn_disc','usdnw_3m', 'usdnw_disc') then 'USD 3sFF' WHEN curve_name = 'gbpnw_disc' THEN 'GBP 3sFF' when curve_name = 'usdn_1m' then 'USD 3s1s' when curve_name= 'eurnw_6m' then 'EUR 6s3s' else 'Other' end type0, sum(USD_IRPV01SPRD) AS USD_IRPV01SPRD, abs(sum(USD_IRPV01SPRD)) AS USD_IRPV01SPRD_ABS FROM cdwuser.u_dm_treasury where CCC_DIVISION = 'TREASURY CAPITAL MARKETS' AND cob_date in ('2018-02-28', '2018-02-27') and USD_IRPV01SPRD IS NOT NULL and CURVE_NAME NOT LIKE 'fxusd%' and CCC_BUSINESS_AREA not in ('MS BANK - PRIVATE BANK1') and CCC_STRATEGY not in ('STRUCTURED N','L-TERM DEBT SN', 'L-TERM DEBT SN ALLOC') and book NOT IN ('AEOEQ', 'LIABB', 'TRPFD', 'PRFEQ', 'TDET2', 'TDET4', 'TDET5', 'TDET6', 'TDET7', 'TDET8', 'LHRO1', 'LHRO2','TSYGLRCSH') GROUP BY cob_date, book, curve_name