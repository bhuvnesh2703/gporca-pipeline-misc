SELECT RANK() OVER (ORDER BY (abs(sum(a.USD_EQ_PARTIAL_KAPPA))) desc) as Rank, CASE WHEN a.PARTIAL_DECOMP_PRODUCT_DESCRIPTION IS NULL THEN 'UNDEFINED' ELSE a.PARTIAL_DECOMP_PRODUCT_DESCRIPTION END PARTIAL_DECOMP_PRODUCT_DESCRIPTION, sum(a.USD_EQ_PARTIAL_KAPPA) as USD_EQ_PARTIAL_KAPPA FROM CDWUSER.U_EXP_MSR_PARTIAL a WHERE a.COB_DATE = '2018-02-28' AND a.CCC_DIVISION = 'INSTITUTIONAL EQUITY DIVISION' AND a.CCC_BANKING_TRADING ='TRADING' AND a.LE_GROUP = 'UK' AND a.ASSET_CLASS = 'EQ' AND ABS(a.USD_EQ_PARTIAL_KAPPA) > 0 AND (a.CASH_ISSUE_TYPE IN ('STOCK', 'ADR') OR a.Partial_Decomp_Sector IN ('STOCK', 'ADR')) GROUP BY a.PARTIAL_DECOMP_PRODUCT_DESCRIPTION ORDER BY ABS(sum(a.USD_EQ_PARTIAL_KAPPA)) DESC FETCH FIRST 10 ROWS ONLY