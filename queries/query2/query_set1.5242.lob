select COB_DATE, a.CCC_TAPS_COMPANY, WM_BANKING_PRODUCT_GROUP, case when BOOK in ('CCISW','DPSWA','DPTSW','IPBSW','IPTSW','PLSWA','RPOFO','RPOHA','RPOHD','RPOHJ','RPOHK','RPOHM','RPOHO','TL2SW', 'CSSW2') then 'Internal Hedges' else 'n/a' end as Hedges, case when Product_Type_Code in ('BOND') then 'Credit' when Product_Type_Code in ('ABS','CDO_CASH','CLO','CMBS') and PRODUCT_SUB_TYPE_CODE not in ('FHLMC','FNMA','GNMA','STU_LOAN','STU_LOAN_FFELP', 'FHLMC_SENIOR') then 'Credit' else 'Other' end as SECTYPE_GROUP, Product_Type_Code, PRODUCT_SUB_TYPE_CODE, FID1_INDUSTRY_NAME_LEVEL2, A.POSITION_ISSUER_PARTY_DARWIN_NAME, MRD_RATING, A.VINTAGE_YEAR, round(COUPON/0.5, 0 )*0.5 as COUPON, CASE WHEN CREDIT_SPREAD <= -50 THEN '<-50' WHEN (CREDIT_SPREAD >-50 AND CREDIT_SPREAD <=0) THEN '-50 - 0' WHEN (CREDIT_SPREAD >0 AND CREDIT_SPREAD <=50) THEN '0 - 50' WHEN (CREDIT_SPREAD >50 AND CREDIT_SPREAD <=100) THEN '50 - 100' WHEN CREDIT_SPREAD >100 THEN '> 100' END AS CREDIT_SPREAD, COALESCE(USD_NOTIONAL, 0) ::numeric(15,5) /1000 as USD_NOTIONAL, COALESCE(USD_MARKET_VALUE, 0) ::numeric(15,5) /1000 as USD_MARKET_VALUE, COALESCE(USD_EXPOSURE, 0) ::numeric(15,5) /1000 as USD_EXPOSURE, COALESCE(USD_IR_UNIFIED_PV01, 0) ::numeric(15,5) /1000 as USD_PV01, COALESCE(USD_PV01SPRD, 0) ::numeric(15,5) /1000 as USD_PV01SPRD, COALESCE(USD_PV10_BENCH, 0) ::numeric(15,5) /1000 as USD_PV10_BENCH, COALESCE(USD_IR_KAPPA, 0) ::numeric(15,5) /10000 as USD_IR_KAPPA, (COALESCE(CREDIT_SPREAD, 0)) *(COALESCE(USD_PV01SPRD, 0)) ::numeric(15,5) /1000 as Spread_x_pv01sprd from CDWUSER.U_DM_WM A where COB_DATE in ( '2018-02-28', '2018-01-31', '2017-12-29', '2017-11-30', '2017-10-31', '2017-09-29', '2017-08-31', '2015-12-31' ) and a.CCC_TAPS_COMPANY = '6635' and CCC_HIERARCHY_LEVEL2 IN ('GLOBAL WEALTH MANAGEMENT', 'WEALTH MANAGEMENT') and CCC_DIVISION in ('PRIVATE BANKING GROUP','RETAIL BANKING GROUP','PWM US BRANCH') and a.WM_BANKING_PRODUCT_GROUP = 'AFS' and VAR_EXCL_FL<> 'Y'