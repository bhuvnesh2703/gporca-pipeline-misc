Select a.COB_DATE, a.BOOK, a.ACCOUNT, a.PRODUCT_TYPE_CODE, a.SPG_DESC, Case WHEN A.ACCOUNT IN ('072006HB8', '07200HTM7', '07200HTS4') THEN 'Risk Retention' WHEN A.BOOK IN ('CRE_LENDING_EU_HFI', 'CRE_LENDING_HFI') THEN 'HFI' WHEN A.PRODUCT_TYPE_CODE = 'LOAN' and A.BOOK IN ('CRE_LENDING_EU_HFS', 'CRE_LENDING_HFS') THEN 'HFS LOANS' WHEN A.PRODUCT_TYPE_CODE = 'CMBS' THEN 'FV CMBS HEDGES' WHEN A.PRODUCT_TYPE_CODE = 'SWAP' AND A.account LIKE '072005%' and a.book in ('CRE_LENDING','CRE_LENDING_EU') THEN 'FV RATELOCK' WHEN A.PRODUCT_TYPE_CODE = 'SWAP' AND A.account LIKE '072005%' and a.book in ('CRE_LENDING_HFS','CRE_LENDING_EU_HFS') THEN 'HFS RATELOCK' WHEN A.PRODUCT_TYPE_CODE = 'SWAP' AND A.account LIKE '08300%' and a.book in ('CRE_LENDING','CRE_LENDING_EU') OR a.book = 'JVFXS' THEN 'FV SWAP HEDGES' WHEN A.PRODUCT_TYPE_CODE = 'SWAP' AND A.account LIKE '08300%' and a.book in ('CRE_LENDING_HFS','CRE_LENDING_EU_HFS') THEN 'HFS SWAP HEDGES' WHEN A.PRODUCT_TYPE_CODE = 'BONDFUT' and a.book in ('CRE_LENDING','CRE_LENDING_EU','CRE_LENDING_HFS','CRE_LENDING_EU_HFS') THEN 'BONDFUTURES' WHEN A.book = 'CRE_LENDING_EU' or (A.book = 'CRE_LENDING' and A.PRODUCT_TYPE_CODE = 'LOAN') THEN 'FV LOANS' WHEN A.book = 'JVFXT' then 'CRD HEDGES' ELSE A.account END AS "SPG GROUPING", sum((a.USD_NOTIONAL) :: numeric(15,5)) AS NET_NOTIONAL, SUM( CASE WHEN ((a.USD_NOTIONAL) :: numeric(15,5)) >= 0 THEN ((a.USD_NOTIONAL) :: numeric(15,5)) ELSE 0 END) AS GROSS_LONG_NOTIONAL, SUM( CASE WHEN ((a.USD_NOTIONAL) :: numeric(15,5)) <0 THEN ((a.USD_NOTIONAL) :: numeric(15,5)) ELSE 0 END) AS GROSS_SHORT_NOTIONAL, SUM((A.USD_EXPOSURE) :: numeric(15,5)) AS NET_EXPOSURE, SUM((A.USD_PV01SPRD) :: numeric(15,5)) AS NET_SPV01, SUM( CASE WHEN ((A.USD_PV01SPRD) :: numeric(15,5)) >=0 THEN ((A.USD_PV01SPRD) :: numeric(15,5)) ELSE 0 END) AS GROSS_SHORT_PV01SPRD, SUM( CASE WHEN ((A.USD_PV01SPRD) :: numeric(15,5)) < 0 THEN ((A.USD_PV01SPRD) :: numeric(15,5)) ELSE 0 END) AS GROSS_LONG_PV01SPRD, SUM((A.USD_IR_UNIFIED_PV01) :: numeric(15,5)) AS USD_PV01, SUM( CASE WHEN ((A.USD_IR_UNIFIED_PV01) :: numeric(15,5)) >=0 THEN ((A.USD_IR_UNIFIED_PV01) :: numeric(15,5)) ELSE 0 END) AS GROSS_SHORT_PV01, SUM( CASE WHEN ((A.USD_IR_UNIFIED_PV01) :: numeric(15,5)) < 0 THEN ((A.USD_IR_UNIFIED_PV01) :: numeric(15,5)) ELSE 0 END) AS GROSS_LONG_PV01 From cdwuser.U_DM_WM a where a.COB_DATE = '2018-02-28' AND A.CCC_TAPS_COMPANY = '1633' AND A.CCC_DIVISION IN ('FIXED INCOME DIVISION', 'NON CORE') AND A.CCC_PRODUCT_LINE in ('CRE LENDING', 'CREL BANK HFI', 'CRE LENDING SEC/HFS') GROUP BY a.COB_DATE, a.BOOK, a.ACCOUNT, a.PRODUCT_TYPE_CODE, a.SPG_DESC, Case WHEN A.ACCOUNT IN ('072006HB8', '07200HTM7', '07200HTS4') THEN 'Risk Retention' WHEN A.BOOK IN ('CRE_LENDING_EU_HFI', 'CRE_LENDING_HFI') THEN 'HFI' WHEN A.PRODUCT_TYPE_CODE = 'LOAN' and A.BOOK IN ('CRE_LENDING_EU_HFS', 'CRE_LENDING_HFS') THEN 'HFS LOANS' WHEN A.PRODUCT_TYPE_CODE = 'CMBS' THEN 'FV CMBS HEDGES' WHEN A.PRODUCT_TYPE_CODE = 'SWAP' AND A.account LIKE '072005%' and a.book in ('CRE_LENDING','CRE_LENDING_EU') THEN 'FV RATELOCK' WHEN A.PRODUCT_TYPE_CODE = 'SWAP' AND A.account LIKE '072005%' and a.book in ('CRE_LENDING_HFS','CRE_LENDING_EU_HFS') THEN 'HFS RATELOCK' WHEN A.PRODUCT_TYPE_CODE = 'SWAP' AND A.account LIKE '08300%' and a.book in ('CRE_LENDING','CRE_LENDING_EU') OR a.book = 'JVFXS' THEN 'FV SWAP HEDGES' WHEN A.PRODUCT_TYPE_CODE = 'SWAP' AND A.account LIKE '08300%' and a.book in ('CRE_LENDING_HFS','CRE_LENDING_EU_HFS') THEN 'HFS SWAP HEDGES' WHEN A.PRODUCT_TYPE_CODE = 'BONDFUT' and a.book in ('CRE_LENDING','CRE_LENDING_EU','CRE_LENDING_HFS','CRE_LENDING_EU_HFS') THEN 'BONDFUTURES' WHEN A.book = 'CRE_LENDING_EU' or (A.book = 'CRE_LENDING' and A.PRODUCT_TYPE_CODE = 'LOAN') THEN 'FV LOANS' WHEN A.book = 'JVFXT' then 'CRD HEDGES' ELSE A.account END