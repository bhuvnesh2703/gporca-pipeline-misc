SELECT CCC_DIVISION, CASE WHEN rank < 8 THEN CCC_BUSINESS_AREA ELSE 'Other' END AS CCC_BUSINESS_AREA, CASE WHEN rank < 8 THEN rank ELSE 8 END AS rank, usd_kappa_cob/10 AS usd_kappa_cob, usd_kappa_change/10 AS usd_kappa_change FROM ( SELECT a.*, rank() over (partition by CCC_DIVISION order by abs(usd_kappa_cob) desc) AS rank FROM( SELECT CCC_DIVISION, CCC_BUSINESS_AREA, SUM(CASE WHEN cob_date = '2018-02-28' THEN coalesce(usd_ir_kappa, 0) ELSE 0 END) AS usd_kappa_cob, SUM(CASE WHEN cob_date = '2018-02-28' THEN coalesce(usd_ir_kappa, 0) ELSE -coalesce(usd_ir_kappa, 0) END) AS usd_kappa_change FROM CDWUSER.U_EXP_MSR WHERE cob_date IN ('2018-02-28', '2018-02-21') AND PARENT_LEGAL_ENTITY = '0517(G)' AND VAR_EXCL_FL <> 'Y' AND ccc_banking_trading = 'TRADING' GROUP BY CCC_DIVISION, CCC_BUSINESS_AREA ) a WHERE abs(coalesce(usd_kappa_cob, 0)) + abs(coalesce(usd_kappa_change, 0)) > 0 ) X