SELECT COB_DATE, CCC_BUSINESS_AREA, CCC_STRATEGY, PRODUCT_TYPE, SOURCE_SCN_NAME, CASE WHEN SOURCE_SCN_NAME LIKE '%022' THEN '_IR PARALLEL (-200)' WHEN SOURCE_SCN_NAME LIKE '%023' THEN '_IR PARALLEL (-100)' WHEN SOURCE_SCN_NAME LIKE '%024' THEN '_IR PARALLEL (-25)' WHEN SOURCE_SCN_NAME LIKE '%025' THEN '_IR PARALLEL (+50)' WHEN SOURCE_SCN_NAME LIKE '%026' THEN '_IR PARALLEL (+100)' WHEN SOURCE_SCN_NAME LIKE '%027' THEN '_IR PARALLEL (+200)' WHEN SOURCE_SCN_NAME LIKE '%028' THEN '_IR PARALLEL (+300)' WHEN SOURCE_SCN_NAME LIKE '%029' THEN '_IR PARALLEL (+400)' WHEN SOURCE_SCN_NAME LIKE '%030' THEN '_IR PARALLEL (+500)' ELSE 'OTHER' END AS SCENARIO, SUM (RAW_PNL) AS PNL FROM DWUSER.U_RAW_SCENARIO_PNL WHERE COB_DATE IN ( '2018-02-28','2018-02-21','2018-01-31' ) AND COB_DATE <'2017-03-22' AND ( SOURCE_SCN_NAME LIKE '%02%' OR SOURCE_SCN_NAME LIKE '%030' ) AND ( MODULAR_SCENARIO_NAME LIKE 'CCAR_IR%' OR MODULAR_SCENARIO_NAME LIKE 'PARA%' ) AND PROCESS_ID=62037 GROUP BY COB_DATE, BU_RISK_SYSTEM, CCC_BUSINESS_AREA, SOURCE_SCN_NAME, CCC_STRATEGY, PRODUCT_TYPE, CASE WHEN SOURCE_SCN_NAME LIKE '%022' THEN '_IR PARALLEL (-200)' WHEN SOURCE_SCN_NAME LIKE '%023' THEN '_IR PARALLEL (-100)' WHEN SOURCE_SCN_NAME LIKE '%024' THEN '_IR PARALLEL (-25)' WHEN SOURCE_SCN_NAME LIKE '%025' THEN '_IR PARALLEL (+50)' WHEN SOURCE_SCN_NAME LIKE '%026' THEN '_IR PARALLEL (+100)' WHEN SOURCE_SCN_NAME LIKE '%027' THEN '_IR PARALLEL (+200)' WHEN SOURCE_SCN_NAME LIKE '%028' THEN '_IR PARALLEL (+300)' WHEN SOURCE_SCN_NAME LIKE '%029' THEN '_IR PARALLEL (+400)' WHEN SOURCE_SCN_NAME LIKE '%030' THEN '_IR PARALLEL (+500)' ELSE 'OTHER' END UNION ALL SELECT COB_DATE, CCC_BUSINESS_AREA, CCC_STRATEGY, PRODUCT_TYPE, SOURCE_SCN_NAME, CASE WHEN SOURCE_SCN_NAME LIKE '%016' THEN '_IR PARALLEL (-200)' WHEN SOURCE_SCN_NAME LIKE '%017' THEN '_IR PARALLEL (-100)' WHEN SOURCE_SCN_NAME LIKE '%018' THEN '_IR PARALLEL (-50)' WHEN SOURCE_SCN_NAME LIKE '%019' THEN '_IR PARALLEL (-25)' WHEN SOURCE_SCN_NAME LIKE '%020' THEN '_IR PARALLEL (+25)' WHEN SOURCE_SCN_NAME LIKE '%021' THEN '_IR PARALLEL (+50)' WHEN SOURCE_SCN_NAME LIKE '%022' THEN '_IR PARALLEL (+100)' WHEN SOURCE_SCN_NAME LIKE '%023' THEN '_IR PARALLEL (+200)' WHEN SOURCE_SCN_NAME LIKE '%024' THEN '_IR PARALLEL (+300)' ELSE 'OTHER' END AS SCENARIO, SUM (RAW_PNL) AS PNL FROM DWUSER.U_RAW_SCENARIO_PNL WHERE COB_DATE IN ( '2018-02-28','2018-02-21','2018-01-31' ) AND COB_DATE >= '2017-03-22' AND BU_RISK_SYSTEM LIKE '%STS_SCENARIOS%' GROUP BY COB_DATE, BU_RISK_SYSTEM, CCC_BUSINESS_AREA, SOURCE_SCN_NAME, CCC_STRATEGY, PRODUCT_TYPE, CASE WHEN SOURCE_SCN_NAME LIKE '%016' THEN '_IR PARALLEL (-200)' WHEN SOURCE_SCN_NAME LIKE '%017' THEN '_IR PARALLEL (-100)' WHEN SOURCE_SCN_NAME LIKE '%018' THEN '_IR PARALLEL (-50)' WHEN SOURCE_SCN_NAME LIKE '%019' THEN '_IR PARALLEL (-25)' WHEN SOURCE_SCN_NAME LIKE '%020' THEN '_IR PARALLEL (+25)' WHEN SOURCE_SCN_NAME LIKE '%021' THEN '_IR PARALLEL (+50)' WHEN SOURCE_SCN_NAME LIKE '%022' THEN '_IR PARALLEL (+100)' WHEN SOURCE_SCN_NAME LIKE '%023' THEN '_IR PARALLEL (+200)' WHEN SOURCE_SCN_NAME LIKE '%024' THEN '_IR PARALLEL (+300)' ELSE 'OTHER' END ;