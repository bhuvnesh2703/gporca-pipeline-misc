With x as ( SELECT a.COB_DATE as ID, a.COB_DATE as COB_DATE, ROUND(sum(coalesce(a.YTD_PL,0))/1000000,2) as YTD_PNL, ROUND(sum(coalesce(a.DAILY_PL,0))/1000000,2) as DAILY_PNL FROM CDWUSER.U_PCT_PNL_CURRENT a WHERE a.COB_DATE >= '2016-01-01' AND a.CCC_DIVISION = 'INSTITUTIONAL EQUITY DIVISION' AND (a.ACCOUNT_PURPOSE_CODE <> 'J' or a.ACCOUNT_PURPOSE_CODE is null) GROUP BY a.COB_DATE ), y as ( SELECT a.COB_DATE as ID, a.COB_DATE, ROUND(VALUE/1000000,2) AS GNURAMV FROM CDWUSER.U_AGGREGATION_DETAIL a, CDWUSER.U_AGGREGATION_SCHEMA s WHERE a.COB_DATE >= '2016-01-01' AND a.HIERARCHY_ID = 2 AND a.LEVEL1 IS NULL AND a.COB_DATE = s.COB_DATE AND a.AGGREGATION_NAME = s.AGGREGATION_NAME AND a.HIERARCHY_ID = s.HIERARCHY_ID AND a.VERSION_ID = s.VERSION_ID AND s.IS_LATEST = 1 GROUP BY a.COB_DATE || '|' || LEVEL1, a.COB_DATE, VALUE ), z as ( SELECT v.cob_Date as ID, cob_date, -ROUND(var05/1000,2) as VAR05, -ROUND(var01/1000,2) as VAR01, ROUND(STDDEV/1000,2) as STDDEV FROM CDWUSER.U_VAR_ID_FLAT_VIEW v WHERE (hierarchy_group_name='EQUITY_CV') AND (hierarchy_name='region') AND v.LEVEL1 IS NULL AND COB_DATE >= '2016-01-01' AND -var05 > 20 ORDER BY v.cob_Date, cob_date, hierarchy_group_name, hierarchy_name, COALESCE(LEVEL1,''), COALESCE(LEVEL2,'') ) SELECT 'Global' as Region, x.COB_DATE, x.YTD_PNL, x.DAILY_PNL, y.GNURAMV, z.VAR01, z.VAR05, z.STDDEV FROM x join y ON x.ID = y.ID and x.cob_date = y.cob_date join z ON x.ID = z.ID and x.cob_date = z.cob_date