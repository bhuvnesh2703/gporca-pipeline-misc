SELECT a.COB_DATE, a.CCC_TAPS_COMPANY, a.account, a.CCC_STRATEGY, a.WM_BANKING_PRODUCT_SUB_GROUP, a.WM_INV_PORTFOLIO, a.MRD_RATING, SUM(COALESCE(USD_IR_KAPPA, 0)::numeric(15,5)/10) AS USD_KAPPA, SUM(COALESCE(USD_IR_UNIFIED_PV01, 0)::numeric(15,5)) AS USD_PV01, SUM(COALESCE(a.USD_PV01SPRD,0))::numeric(15,5)/1000 AS usd_pv01sprd, SUM(COALESCE(a.USD_NOTIONAL,0))::numeric(15,5)/1000 as usd_notional, sum(COALESCE(USD_EXPOSURE, 0))::numeric(15,5) / 1000 AS USD_EXPOSURE, sum(COALESCE(USD_PROCEED, 0))::numeric(15,5) / 1000 AS MV, SUM (CASE WHEN a.WM_BANKING_PRODUCT_SUB_GROUP = 'Swaption' THEN COALESCE (SLIDE_IR_MIN_100BP_USD,0) ELSE COALESCE (SLIDE_IR_MIN_100BP_USD, USD_PV01 * - 100) END) ::numeric(15,5) AS SLIDE_IR_MIN_100BP_USD, SUM (CASE WHEN a.WM_BANKING_PRODUCT_SUB_GROUP = 'Swaption' THEN COALESCE (SLIDE_IR_MIN_200BP_USD,0) ELSE COALESCE (SLIDE_IR_MIN_200BP_USD, USD_PV01 * - 200) END) ::numeric(15,5) AS SLIDE_IR_MIN_200BP_USD, SUM (CASE WHEN a.WM_BANKING_PRODUCT_SUB_GROUP = 'Swaption' THEN COALESCE (SLIDE_IR_MIN_300BP_USD,0) ELSE COALESCE (SLIDE_IR_MIN_300BP_USD, USD_PV01 * - 300) END) ::numeric(15,5) AS SLIDE_IR_MIN_300BP_USD, SUM (CASE WHEN a.WM_BANKING_PRODUCT_SUB_GROUP = 'Swaption' THEN COALESCE (SLIDE_IR_MIN_50BP_USD,0) ELSE COALESCE (SLIDE_IR_MIN_50BP_USD, USD_PV01 * - 50) END) ::numeric(15,5) AS SLIDE_IR_MIN_50BP_USD, SUM (CASE WHEN a.WM_BANKING_PRODUCT_SUB_GROUP = 'Swaption' THEN COALESCE (SLIDE_IR_PLS_50BP_USD,0) ELSE COALESCE (SLIDE_IR_PLS_50BP_USD, USD_PV01 * 50) END) ::numeric(15,5) AS SLIDE_IR_PLS_50BP_USD, SUM (CASE WHEN a.WM_BANKING_PRODUCT_SUB_GROUP = 'Swaption' THEN COALESCE (SLIDE_IR_PLS_100BP_USD,0) ELSE COALESCE (SLIDE_IR_PLS_100BP_USD, USD_PV01 * 100) END) ::numeric(15,5) AS SLIDE_IR_PLS_100BP_USD, SUM (CASE WHEN a.WM_BANKING_PRODUCT_SUB_GROUP = 'Swaption' THEN COALESCE (SLIDE_IR_PLS_200BP_USD,0) ELSE COALESCE (SLIDE_IR_PLS_200BP_USD, USD_PV01 * 200) END) ::numeric(15,5) AS SLIDE_IR_PLS_200BP_USD, SUM (CASE WHEN a.WM_BANKING_PRODUCT_SUB_GROUP = 'Swaption' THEN COALESCE (SLIDE_IR_PLS_300BP_USD,0) ELSE COALESCE (SLIDE_IR_PLS_300BP_USD, USD_PV01 * 300) END) ::numeric(15,5) AS SLIDE_IR_PLS_300BP_USD FROM cdwuser.U_DM_WM_POSITION A WHERE COB_DATE in ( '2018-02-28', '2018-02-27', '2018-01-31', '2017-12-29', '2017-11-30', '2017-10-31', '2015-12-31' ) AND A.CCC_TAPS_COMPANY = '6635' AND (A.VAR_EXCL_FL<> 'Y' OR A.BOOK IN ('MSDPB3M','MSDPT3M')) AND (A.ccc_banking_trading = 'BANKING' OR (A.CCC_HIERARCHY_LEVEL2 IN ('WEALTH MANAGEMENT', 'GLOBAL WEALTH MANAGEMENT') or a.CCC_business_area = 'US BANKS-LIQUIDITY') AND A.PRODUCT_TYPE_CODE ='REPO' AND A.CCC_BUSINESS_AREA NOT IN ('NON CORE MARKETS','CORE MARKETS')) GROUP BY a.COB_DATE, a.CCC_TAPS_COMPANY, a.account, a.CCC_STRATEGY, a.WM_BANKING_PRODUCT_SUB_GROUP, a.WM_INV_PORTFOLIO, a.MRD_RATING