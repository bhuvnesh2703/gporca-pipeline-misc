SELECT a.COB_DATE, case when TERM_NEW <= 0.25 then 0.25 when TERM_NEW = 0.75 then 1 else TERM_NEW end as TERM_NEW, case when curve_name in ('eurnw_1m', 'eurnw_disc', 'eurnw_6m', 'eurnw_12m', 'fxusdeur') then 'EUR' when curve_name in ('usdnw_1m', 'usdn_1m', 'usdlibor1m', 'usdnw_disc', 'usdn_3m', 'usdn_disc', 'usdnw_6m', 'usdn_6m', 'usdnw_12m', 'usdn_12m') then 'USD' when curve_name in ('jpynw_1m', 'jpymu_1m', 'jpymu_tib1', 'jpynw_3m', 'jpymu_3m', 'jpynw_6m', 'jpymu_6m', 'jpymu_tib6', 'jpynw_12m', 'jpymu_12m', 'fxusdjpy') then 'JPY' when curve_name in ('gbpnw_1m', 'gbpnw_disc', 'gbpnw_6m', 'gbpnw_12m', 'fxusdgbp') then 'GBP' when curve_name in ('audnw_1m', 'audn_1m', 'chfnw_1m', 'nok3w_1m', 'seknw_1m', 'cadnw_1m', 'hkdn_1m', 'sgdn_1m', 'audnw_3m', 'audn_disc', 'chfnw_3m', 'chf36_3m', 'seknw_disc', 'cadnw_disc', 'czk36_3m', 'hkdn_disc', 'nzdn_disc', 'nzdnw_3m', 'sgdn_3m', 'sgdn_disc', 'audnw_6m', 'audn_6m', 'chfnw_6m', 'chf36_6m', 'nok3w_6m', 'seknw_6m', 'dkk2w_6m', 'czk36_6m', 'audnw_12m', 'audn_12m', 'chf36_12m', 'nok3w_12m', 'seknw_12m', 'dkk2w_12m', 'chfnw_12m','fxusdaud', 'fxusdchf', 'fxusdnok', 'fxusdsek', 'fxusddkk', 'fxusdcad', 'fxusdkrw', 'fxusdkr1', 'fxusdkr2', 'fxusdmyr', 'fxusdbr1', 'fxusdhkd', 'fxusdhuf', 'fxusdidr', 'fxusdmxn', 'fxusdnzd', 'fxusdsgd', 'fxusdthb', 'fxusdtry', 'fxusdtwd', 'fxusdzar', 'fxusdcnh', 'fxusdcny') then 'OTHER' end as CURRENCY_COMBINED, SUM (a.USD_IRPV01SPRD) AS IRPV01SPRD, CASE WHEN curve_name in ('fxusdeur','fxusdgbp','fxusdjpy','fxusdaud', 'fxusdchf', 'fxusdnok', 'fxusdsek', 'fxusddkk', 'fxusdcad', 'fxusdkrw', 'fxusdkr1', 'fxusdkr2', 'fxusdmyr', 'fxusdbr1', 'fxusdhkd', 'fxusdhuf', 'fxusdidr', 'fxusdmxn', 'fxusdnzd', 'fxusdsgd', 'fxusdthb', 'fxusdtry', 'fxusdtwd', 'fxusdzar', 'fxusdcnh', 'fxusdcny') THEN 'xccy' WHEN curve_name in ('eurnw_1m','gbpnw_1m','usdnw_1m', 'usdn_1m', 'usdlibor1m','jpynw_1m', 'jpymu_1m','jpymu_tib1','chfnw_1m', 'nok3w_1m', 'seknw_1m','audnw_1m', 'audn_1m', 'cadnw_1m','hkdn_1m', 'sgdn_1m') THEN '1-3m' WHEN curve_name in ('eurnw_6m','gbpnw_6m','usdnw_6m', 'usdn_6m','jpynw_6m', 'jpymu_6m', 'jpymu_tib6','audnw_6m', 'audn_6m', 'chfnw_6m', 'chf36_6m', 'nok3w_6m', 'seknw_6m', 'dkk2w_6m', 'czk36_6m') THEN '3-6m' WHEN curve_name in ('eurnw_disc','gbpnw_disc','usdnw_disc', 'usdn_3m', 'usdn_disc','jpynw_3m', 'jpymu_3m','chfnw_3m', 'chf36_3m', 'seknw_disc', 'audnw_3m', 'audn_disc', 'cadnw_disc','czk36_3m', 'hkdn_disc', 'nzdn_disc', 'nzdnw_3m', 'sgdn_3m', 'sgdn_disc') THEN 'OIS' WHEN curve_name in ('eurnw_12m','gbpnw_12m','usdnw_12m', 'usdn_12m','jpynw_12m', 'jpymu_12m','audnw_12m', 'audn_12m', 'chf36_12m', 'nok3w_12m', 'seknw_12m', 'dkk2w_12m', 'chfnw_12m') THEN '6-12m' ELSE 'Other' END AS basistype, CURVE_NAME from cdwuser.U_IR_MSR_INTRPLT a WHERE cob_date in ('2018-02-28','2018-02-27') AND A.USD_IRPV01SPRD <> 0 AND VERTICAL_SYSTEM NOT LIKE '%EQUITY%' AND CCC_PL_REPORTING_REGION = 'EMEA' AND CCC_BUSINESS_AREA in ('STRUCTURED RATES') GROUP BY a.COB_DATE, TERM_NEW, A.CURVE_NAME