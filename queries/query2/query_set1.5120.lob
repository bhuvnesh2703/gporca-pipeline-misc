SELECT current.COB_DATE, current.VINTAGE, current.CMBS_RATING, current.SPV01, coalesce(current.SPV01,0) - coalesce(previous.SPV01,0) as SPV01_CHG From (select v.COB_DATE, v.PRODUCT_TYPE_CODE, v.VINTAGE, v.CMBS_RATING, sum((v.USD_PV01SPRD) :: numeric(15,5)) as SPV01 FROM CDWUSER.U_DM_WM v where v.COB_DATE in ( '2018-02-28' ) and v.CCC_TAPS_COMPANY = '1633' and v.CCC_DIVISION in ('FIXED INCOME DIVISION','NON CORE') and v.CCC_BUSINESS_AREA = 'SECURITIZED PRODUCTS GRP' and v.CCC_PRODUCT_LINE in ('CRE LENDING', 'CREL BANK HFI', 'CRE LENDING SEC/HFS') and v.PRODUCT_TYPE_CODE = 'CMBS' group by v.COB_DATE, v.PRODUCT_TYPE_CODE, v.VINTAGE, v.CMBS_RATING) current full outer join (select v.COB_DATE, v.PRODUCT_TYPE_CODE, v.VINTAGE, v.CMBS_RATING, sum((v.USD_PV01SPRD) :: numeric(15,5)) as SPV01 FROM CDWUSER.U_DM_WM v where v.COB_DATE in ( '2018-01-31' ) and v.CCC_TAPS_COMPANY = '1633' and v.CCC_DIVISION in ('FIXED INCOME DIVISION','NON CORE') and v.CCC_BUSINESS_AREA = 'SECURITIZED PRODUCTS GRP' and v.CCC_PRODUCT_LINE in ('CRE LENDING', 'CREL BANK HFI', 'CRE LENDING SEC/HFS') and v.PRODUCT_TYPE_CODE = 'CMBS' group by v.COB_DATE, v.PRODUCT_TYPE_CODE, v.VINTAGE, v.CMBS_RATING ) previous on current.CMBS_RATING = previous.CMBS_RATING and current.VINTAGE = previous.VINTAGE