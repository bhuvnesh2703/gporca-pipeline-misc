select NE.COB_DATE, NE.POSITION_ISSUER_PARTY_DARWIN_NAME, NE.BOOK, NE.INSURER_RATING, NE.CUR_USD_EXPOSURE, NE.CUR_USD_NOTIONAL, NOTIONAL.PRE_USD_EXPOSURE, NOTIONAL.PRE_USD_NOTIONAL from (select a.COB_DATE, a.POSITION_ISSUER_PARTY_DARWIN_NAME, a.BOOK, a.INSURER_RATING, sum((a.USD_EXPOSURE) :: numeric(15,5)) as CUR_USD_EXPOSURE,sum((a.USD_NOTIONAL) :: numeric(15,5)) as CUR_USD_NOTIONAL from cdwuser.U_DM_WM a where a.COB_DATE IN ( '2018-02-28' ) and a.CCC_PRODUCT_LINE = 'WAREHOUSE' and a.spg_desc like 'WAREHOUSE%' and a.CCC_TAPS_COMPANY = '1633' group by a.COB_DATE, a.POSITION_ISSUER_PARTY_DARWIN_NAME, a.BOOK, a.INSURER_RATING) NE left join (select a.COB_DATE, a.POSITION_ISSUER_PARTY_DARWIN_NAME, sum((a.USD_NOTIONAL) :: numeric(15,5)) as PRE_USD_NOTIONAL,sum((a.USD_EXPOSURE) :: numeric(15,5)) as PRE_USD_EXPOSURE from cdwuser.U_DM_WM a where a.COB_DATE IN ( '2018-02-27' ) and a.CCC_PRODUCT_LINE = 'WAREHOUSE' and a.spg_desc like 'WAREHOUSE%' and a.CCC_TAPS_COMPANY = '1633' Group by a.COB_DATE, a.POSITION_ISSUER_PARTY_DARWIN_NAME ) notional on NE.POSITION_ISSUER_PARTY_DARWIN_NAME = notional.POSITION_ISSUER_PARTY_DARWIN_NAME order by NE.CUR_USD_EXPOSURE desc fetch first 20 rows only