with a as ( SELECT cob_date, moddef.PARALLEL_YC_MOVE_BPS, moddef.equity_spot_pct_move, SUM(PNL) as pnl FROM DWUSER.U_MODULAR_SCENARIOS_AGGREGATE modval INNER JOIN DWUSER.U_STRESS_SCENARIO_ATTRIBS moddef ON modval.STRESS_SCENARIO = moddef.SCENARIO_NM WHERE cob_date > '2018-02-07' AND run_profile IN ( 'STS_MOD_SCN_RUN_NY' ,'STS_MOD_SCN_RUN_LN' ,'STS_MOD_SCN_RUN_ASIA') AND book IN ( 'USHYB' ,'NYEJV', 'ACCOM') AND moddef.SCENARIO_TYPE in ('IR-EQ','IR') and scenario_currency='USD' and pct_ir_vol_move='0' and modval.SCENARIO_TYPE='FULL_REVAL' and YC_PCA_2_UNITS = 'PARALLEL' AND equity_vol_pct_move = '0' and PARALLEL_YC_MOVE_BPS in ('-50','100', '0') and modval.PNL != 0 GROUP BY cob_date, moddef.PARALLEL_YC_MOVE_BPS, moddef.equity_spot_pct_move ) select * from a where cob_date=(select max(cob_date) from a)