SELECT a.cob_date , a.LEVEL1 , a.LEVEL2 , a.LEVEL3 , case when a.LEVEL4 is null then 'TOTAL' else a.LEVEL4 end as LEVEL4 , sum(a.value) as GNURAM FROM dwuser.U_Aggregation_Detail a , dwuser.U_Aggregation_Schema b WHERE a.COB_DATE in ('2018-02-28','2018-01-31','2017-12-29','2017-11-30','2017-10-31','2017-09-29','2017-08-31','2017-07-31','2017-06-30','2017-05-31','2017-04-28','2017-03-31','2017-02-28') AND a.COB_DATE=b.COB_DATE AND a.version_id=b.version_id AND a.hierarchy_id=b.hierarchy_id AND a.aggregation_name=b.aggregation_name AND a.aggregation_name='EQ_GNURAM' AND a.HIERARCHY_ID = 12 AND a.level1='0302(G)' AND a.level2 = 'AMERICAS' and a.level3 is not null AND a.level5 IS NULL AND b.is_latest=1 GROUP BY a.cob_date , a.LEVEL1 , a.LEVEL2 , a.LEVEL3 , a.LEVEL4