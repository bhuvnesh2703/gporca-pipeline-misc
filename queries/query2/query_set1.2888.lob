select CCC_BANKING_TRADING, CURVE_NAME, LE_GROUP, CCC_PL_REPORTING_REGION AS CCC_PL_REPORTING_REGION_1, CASE WHEN CCC_PL_REPORTING_REGION IN ('ASIA PACIFIC','JAPAN') THEN 'ASIA' ELSE CCC_PL_REPORTING_REGION END AS CCC_PL_REPORTING_REGION, CASE WHEN CURVE_NAME in ('fxusdaed') THEN 'AED' WHEN CURVE_NAME in ('fxusdaud','audn_disc', 'audnw_disc', 'audnw_3m','audn_1m', 'audnw_1m','audn_6m', 'audnw_6m') THEN 'AUD' WHEN CURVE_NAME in ('fxusdbr1') THEN 'BRL' WHEN CURVE_NAME in ('cadnw_1m','fxusdcad','cadnw_disc') THEN 'CAD' WHEN CURVE_NAME in ('fxusdchf','chfnw_3m', 'chfnw_1m', 'chfnw_6m','chfnw_12m') THEN 'CHF' WHEN CURVE_NAME in ('fxusdclp') THEN 'CLP' WHEN CURVE_NAME in ('fxusdclu') THEN 'CLU' WHEN CURVE_NAME in ('fxusdcnh') THEN 'CNH' WHEN CURVE_NAME in ('fxusdcny') THEN 'CNY' WHEN CURVE_NAME in ('czknw_1m','czknw_6m','fxusdczk', 'czknw_disc') THEN 'CZK' WHEN CURVE_NAME in ('dkk2w_6m', 'fxusddkk') THEN 'DKK' WHEN CURVE_NAME in ('fxusdeur','eurnw_disc','eurnw_1m','eurnw_6m','eurnw_12m') THEN 'EUR' WHEN CURVE_NAME in ('fxusdgbp','gbpnw_disc','gbpnw_1m','gbpnw_6m','gbpnw_12m') THEN 'GBP' WHEN CURVE_NAME in ('hkdn_1m','fxusdhkd','hkdn_disc') THEN 'HKD' WHEN CURVE_NAME in ('fxusdidr') THEN 'IDR' WHEN CURVE_NAME in ('fxusdils') THEN 'ILS' WHEN CURVE_NAME in ('fxusdinr') THEN 'INR' WHEN CURVE_NAME in ('fxusdjpy','jpynw_3m', 'jpymu_3m','jpynw_1m','jpynw_6m', 'jpymu_6m','jpynw_12m', 'jpymu_12m') THEN 'JPY' WHEN CURVE_NAME in ('fxusdkrw') THEN 'KRW' WHEN CURVE_NAME in ('fxusdmxn') THEN 'MXN' WHEN CURVE_NAME in ('fxusdnok') THEN 'NOK' WHEN CURVE_NAME in ('fxusdnzd','nzdnw_3m') THEN 'NZD' WHEN CURVE_NAME in ('fxusdpen') THEN 'PEN' WHEN CURVE_NAME in ('fxusdrub') THEN 'RUB' WHEN CURVE_NAME in ('fxusdsar') THEN 'SAR' WHEN CURVE_NAME in ('fxusdsek','seknw_disc') THEN 'SEK' WHEN CURVE_NAME in ('fxusdsgd','sgdn_disc') THEN 'SGD' WHEN CURVE_NAME in ('spplib_6m') THEN 'SPP' WHEN CURVE_NAME in ('fxusdtry') THEN 'TRY' WHEN CURVE_NAME in ('fxusdtwd') THEN 'TWD' WHEN CURVE_NAME in ('usdn_3m', 'usdn_disc', 'usdnw_3m','usdn_1m', 'usdnw_1m', 'usdlibor1m','usdn_6m', 'usdnw_6m','usdn_12m') THEN 'USD' WHEN CURVE_NAME in ('fxusdzar') THEN 'ZAR' Else 'Other' end as Curve_Currency, CASE WHEN curve_name in ('fxusdeur','fxusdgbp','fxusdjpy','fxusdaud', 'fxusdchf', 'fxusdnok', 'fxusdsek', 'fxusddkk', 'fxusdcad', 'fxusdkrw', 'fxusdkr1', 'fxusdkr2', 'fxusdmyr', 'fxusdbr1', 'fxusdhkd', 'fxusdhuf', 'fxusdidr', 'fxusdmxn', 'fxusdnzd', 'fxusdsgd', 'fxusdthb', 'fxusdtry', 'fxusdtwd', 'fxusdzar', 'fxusdcnh', 'fxusdcny') THEN 'Cross-Currency' WHEN curve_name in ('eurnw_1m','gbpnw_1m','usdnw_1m', 'usdn_1m', 'usdlibor1m','jpynw_1m', 'jpymu_1m','jpymu_tib1','chfnw_1m', 'nok3w_1m', 'seknw_1m','audnw_1m', 'audn_1m', 'cadnw_1m','hkdn_1m', 'sgdn_1m') THEN '1m/3m' WHEN curve_name in ('eurnw_6m','gbpnw_6m','usdnw_6m', 'usdn_6m','jpynw_6m', 'jpymu_6m', 'jpymu_tib6','audnw_6m', 'audn_6m', 'chfnw_6m', 'chf36_6m', 'nok3w_6m', 'seknw_6m', 'dkk2w_6m', 'czk36_6m') THEN '3m/6m' WHEN curve_name in ('eurnw_disc','gbpnw_disc','usdnw_3m', 'usdn_disc','jpynw_3m', 'jpymu_3m','chfnw_3m', 'chf36_3m', 'seknw_disc', 'audnw_3m', 'audn_disc', 'cadnw_disc','czk36_3m', 'hkdn_disc', 'nzdn_disc', 'nzdnw_3m', 'sgdn_3m', 'sgdn_disc') THEN 'OIS/Libor' WHEN curve_name in ('eurnw_12m','gbpnw_12m','usdnw_12m', 'usdn_12m','jpynw_12m', 'jpymu_12m','audnw_12m', 'audn_12m', 'chf36_12m', 'nok3w_12m', 'seknw_12m', 'dkk2w_12m', 'chfnw_12m') THEN '6m/12m' ELSE 'Other' END AS Basis_Type, CASE WHEN TERM_BUCKET = '0-0.083Y' THEN '1m' WHEN TERM_BUCKET = '0.083-0.25Y' THEN '3m' WHEN TERM_BUCKET = '0.25-0.5Y' THEN '6m' WHEN TERM_BUCKET = '0.5-0.75Y' THEN '9m' WHEN TERM_BUCKET = '0.75-1Y' THEN '1y' WHEN TERM_BUCKET = '1-2Y' THEN '2y' WHEN TERM_BUCKET in ('2-3Y','3-5Y') THEN '5y' WHEN TERM_BUCKET in ('7-8Y','8-10Y','5-7Y') THEN '10y' WHEN TERM_BUCKET in ('12-15Y','10-12Y','15-20Y') THEN '20y' WHEN TERM_BUCKET in ('20-25Y','30-40Y','60-75Y','25-30Y','40-50Y','50-60Y','75+Y') THEN '20y+' Else 'Other' end as Term_Bucket, sum(USD_IRPV01SPRD) as Basis_Risk from cdwuser.u_exp_msr a where a.COB_DATE in ('2018-02-28') and DIVISION = 'IED' and USD_IRPV01SPRD <> '0' group by CCC_BANKING_TRADING, CURVE_NAME, LE_GROUP, CCC_PL_REPORTING_REGION, CASE WHEN CURVE_NAME in ('fxusdaed') THEN 'AED' WHEN CURVE_NAME in ('fxusdaud','audn_disc', 'audnw_disc', 'audnw_3m','audn_1m', 'audnw_1m','audn_6m', 'audnw_6m') THEN 'AUD' WHEN CURVE_NAME in ('fxusdbr1') THEN 'BRL' WHEN CURVE_NAME in ('cadnw_1m','fxusdcad','cadnw_disc') THEN 'CAD' WHEN CURVE_NAME in ('fxusdchf','chfnw_3m', 'chfnw_1m', 'chfnw_6m','chfnw_12m') THEN 'CHF' WHEN CURVE_NAME in ('fxusdclp') THEN 'CLP' WHEN CURVE_NAME in ('fxusdclu') THEN 'CLU' WHEN CURVE_NAME in ('fxusdcnh') THEN 'CNH' WHEN CURVE_NAME in ('fxusdcny') THEN 'CNY' WHEN CURVE_NAME in ('czknw_1m','czknw_6m','fxusdczk', 'czknw_disc') THEN 'CZK' WHEN CURVE_NAME in ('dkk2w_6m', 'fxusddkk') THEN 'DKK' WHEN CURVE_NAME in ('fxusdeur','eurnw_disc','eurnw_1m','eurnw_6m','eurnw_12m') THEN 'EUR' WHEN CURVE_NAME in ('fxusdgbp','gbpnw_disc','gbpnw_1m','gbpnw_6m','gbpnw_12m') THEN 'GBP' WHEN CURVE_NAME in ('hkdn_1m','fxusdhkd','hkdn_disc') THEN 'HKD' WHEN CURVE_NAME in ('fxusdidr') THEN 'IDR' WHEN CURVE_NAME in ('fxusdils') THEN 'ILS' WHEN CURVE_NAME in ('fxusdinr') THEN 'INR' WHEN CURVE_NAME in ('fxusdjpy','jpynw_3m', 'jpymu_3m','jpynw_1m','jpynw_6m', 'jpymu_6m','jpynw_12m', 'jpymu_12m') THEN 'JPY' WHEN CURVE_NAME in ('fxusdkrw') THEN 'KRW' WHEN CURVE_NAME in ('fxusdmxn') THEN 'MXN' WHEN CURVE_NAME in ('fxusdnok') THEN 'NOK' WHEN CURVE_NAME in ('fxusdnzd','nzdnw_3m') THEN 'NZD' WHEN CURVE_NAME in ('fxusdpen') THEN 'PEN' WHEN CURVE_NAME in ('fxusdrub') THEN 'RUB' WHEN CURVE_NAME in ('fxusdsar') THEN 'SAR' WHEN CURVE_NAME in ('fxusdsek','seknw_disc') THEN 'SEK' WHEN CURVE_NAME in ('fxusdsgd','sgdn_disc') THEN 'SGD' WHEN CURVE_NAME in ('spplib_6m') THEN 'SPP' WHEN CURVE_NAME in ('fxusdtry') THEN 'TRY' WHEN CURVE_NAME in ('fxusdtwd') THEN 'TWD' WHEN CURVE_NAME in ('usdn_3m', 'usdn_disc', 'usdnw_3m','usdn_1m', 'usdnw_1m', 'usdlibor1m','usdn_6m', 'usdnw_6m','usdn_12m') THEN 'USD' WHEN CURVE_NAME in ('fxusdzar') THEN 'ZAR' Else 'Other' end , CASE WHEN curve_name in ('fxusdeur','fxusdgbp','fxusdjpy','fxusdaud', 'fxusdchf', 'fxusdnok', 'fxusdsek', 'fxusddkk', 'fxusdcad', 'fxusdkrw', 'fxusdkr1', 'fxusdkr2', 'fxusdmyr', 'fxusdbr1', 'fxusdhkd', 'fxusdhuf', 'fxusdidr', 'fxusdmxn', 'fxusdnzd', 'fxusdsgd', 'fxusdthb', 'fxusdtry', 'fxusdtwd', 'fxusdzar', 'fxusdcnh', 'fxusdcny') THEN 'Cross-Currency' WHEN curve_name in ('eurnw_1m','gbpnw_1m','usdnw_1m', 'usdn_1m', 'usdlibor1m','jpynw_1m', 'jpymu_1m','jpymu_tib1','chfnw_1m', 'nok3w_1m', 'seknw_1m','audnw_1m', 'audn_1m', 'cadnw_1m','hkdn_1m', 'sgdn_1m') THEN '1m/3m' WHEN curve_name in ('eurnw_6m','gbpnw_6m','usdnw_6m', 'usdn_6m','jpynw_6m', 'jpymu_6m', 'jpymu_tib6','audnw_6m', 'audn_6m', 'chfnw_6m', 'chf36_6m', 'nok3w_6m', 'seknw_6m', 'dkk2w_6m', 'czk36_6m') THEN '3m/6m' WHEN curve_name in ('eurnw_disc','gbpnw_disc','usdnw_3m', 'usdn_disc','jpynw_3m', 'jpymu_3m','chfnw_3m', 'chf36_3m', 'seknw_disc', 'audnw_3m', 'audn_disc', 'cadnw_disc','czk36_3m', 'hkdn_disc', 'nzdn_disc', 'nzdnw_3m', 'sgdn_3m', 'sgdn_disc') THEN 'OIS/Libor' WHEN curve_name in ('eurnw_12m','gbpnw_12m','usdnw_12m', 'usdn_12m','jpynw_12m', 'jpymu_12m','audnw_12m', 'audn_12m', 'chf36_12m', 'nok3w_12m', 'seknw_12m', 'dkk2w_12m', 'chfnw_12m') THEN '6m/12m' ELSE 'Other' END , CASE WHEN TERM_BUCKET = '0-0.083Y' THEN '1m' WHEN TERM_BUCKET = '0.083-0.25Y' THEN '3m' WHEN TERM_BUCKET = '0.25-0.5Y' THEN '6m' WHEN TERM_BUCKET = '0.5-0.75Y' THEN '9m' WHEN TERM_BUCKET = '0.75-1Y' THEN '1y' WHEN TERM_BUCKET = '1-2Y' THEN '2y' WHEN TERM_BUCKET in ('2-3Y','3-5Y') THEN '5y' WHEN TERM_BUCKET in ('7-8Y','8-10Y','5-7Y') THEN '10y' WHEN TERM_BUCKET in ('12-15Y','10-12Y','15-20Y') THEN '20y' WHEN TERM_BUCKET in ('20-25Y','30-40Y','60-75Y','25-30Y','40-50Y','50-60Y','75+Y') THEN '20y+' Else 'Other' end