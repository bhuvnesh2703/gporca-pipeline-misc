select A.POSITION_ULT_ISSUER_PARTY_DARWIN_NAME, sum(case when A.COB_DATE = '2018-02-28' then USD_PV10_BENCH else 0 end) as PV10, sum(case when A.COB_DATE = '2018-02-28' then USD_PV10_BENCH else -USD_PV10_BENCH end) as PV10chng, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='HONG KONG') then USD_PV10_BENCH else 0 end) as PV10HK, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='PARIS') then A.USD_PV10_BENCH else 0 end) as PV10PARIS, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='TOKYO') then USD_PV10_BENCH else 0 end) as PV10Tokyo, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='SYDNEY') then USD_PV10_BENCH else 0 end) as PV10Sydney, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='SINGAPORE') then USD_PV10_BENCH else 0 end) as PV10Singapore, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='NEW YORK') then USD_PV10_BENCH else 0 end) as PV10NY, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='ISTANBUL') then USD_PV10_BENCH else 0 end) as PV10Instanbul, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='BEIJING') then USD_PV10_BENCH else 0 end) as PV10BEIJING, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='MOSCOW') then USD_PV10_BENCH else 0 end) as PV10Moscow, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='SEOUL') then USD_PV10_BENCH else 0 end) as PV10SEOUL, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='MEXICO CITY') then USD_PV10_BENCH else 0 end) as PV10MEXCity, sum(case when (A.COB_DATE = '2018-02-28' AND a.RISK_MANAGER_LOCATION='SAO PAULO') then USD_PV10_BENCH else 0 end) as PV10SPAULO FROM CDWUSER.U_EXP_MSR A WHERE A.cob_date in ('2018-02-28', '2018-01-31') and a.CCC_BUSINESS_AREA ='EM CREDIT TRADING' AND USD_PV10_BENCH IS NOT NULL AND ccc_banking_trading='TRADING' AND parent_legal_entity = '0302(G)' and A.POSITION_ULT_ISSUER_PARTY_DARWIN_NAME <>'UNDEFINED' AND a.RISK_MANAGER_LOCATION <> 'LONDON' group by A.POSITION_ULT_ISSUER_PARTY_DARWIN_NAME order by SUM (case when A.COB_DATE = '2018-02-28' then abs(USD_PV10_BENCH) else 0 end) desc