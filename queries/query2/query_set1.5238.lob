/*CREDIT CORP SECTOR AND ISSUER*/ SELECT a.cob_date, max(abs(A.USD_PV01SPRD)) AS CREDIT_CORP_SECTOR_USD_PV01SPRD, 0 AS CREDIT_CORP_SECTOR_USD_PV10_BENCH, 0 AS CREDIT_CORP_ISSUER_USD_PV01SPRD, 0 AS CREDIT_CORP_ISSUER_USD_PV10_BENCH, 0 AS CREDIT_CMBS_ISSUER_USD_EXPOSURE, 0 AS CREDIT_CLO_ISSUER_USD_EXPOSURE, 0 AS CREDIT_AUTO_ISSUER_USD_EXPOSURE FROM ( SELECT a.COB_DATE, a.FID1_INDUSTRY_NAME_LEVEL2, sum(COALESCE(USD_PV01SPRD ::numeric(15,5), 0)) as USD_PV01SPRD from cdwuser.U_DM_WM A where a.cob_date in ( '2018-02-28', '2018-01-31', '2017-12-29', '2017-11-30', '2017-10-31', '2017-09-29', '2017-08-31', '2017-07-31' ) and a.book in ('AFSC2') and a.ccc_taps_company in ('6635') GROUP BY a.COB_DATE, a.FID1_INDUSTRY_NAME_LEVEL2 ) a group by a.COB_DATE UNION ALL SELECT a.cob_date, 0 AS CREDIT_CORP_SECTOR_USD_PV01SPRD, max(abs(A.USD_PV10_BENCH)) AS CREDIT_CORP_SECTOR_USD_PV10_BENCH, 0 AS CREDIT_CORP_ISSUER_USD_PV01SPRD, 0 AS CREDIT_CORP_ISSUER_USD_PV10_BENCH, 0 AS CREDIT_CMBS_ISSUER_USD_EXPOSURE, 0 AS CREDIT_CLO_ISSUER_USD_EXPOSURE, 0 AS CREDIT_AUTO_ISSUER_USD_EXPOSURE FROM ( SELECT a.COB_DATE, a.FID1_INDUSTRY_NAME_LEVEL2, Sum(COALESCE(USD_PV10_BENCH ::numeric(15,5), 0)) as USD_PV10_BENCH from cdwuser.U_DM_WM A where a.cob_date in ( '2018-02-28', '2018-01-31', '2017-12-29', '2017-11-30', '2017-10-31', '2017-09-29', '2017-08-31', '2017-07-31' ) and a.book in ('AFSC2') and a.ccc_taps_company in ('6635') GROUP BY a.COB_DATE, a.FID1_INDUSTRY_NAME_LEVEL2 ) a group by a.COB_DATE union all SELECT a.cob_date, 0 AS CREDIT_CORP_SECTOR_USD_PV01SPRD, 0 AS CREDIT_CORP_SECTOR_USD_PV10_BENCH, max(abs(A.USD_PV01SPRD)) AS CREDIT_CORP_ISSUER_USD_PV01SPRD, 0 AS CREDIT_CORP_ISSUER_USD_PV10_BENCH, 0 AS CREDIT_CMBS_ISSUER_USD_EXPOSURE, 0 AS CREDIT_CLO_ISSUER_USD_EXPOSURE, 0 AS CREDIT_AUTO_ISSUER_USD_EXPOSURE FROM ( SELECT a.COB_DATE, a.POSITION_ID, sum(COALESCE(USD_PV01SPRD ::numeric(15,5), 0)) as USD_PV01SPRD from cdwuser.U_DM_WM_POSITION A where a.cob_date in ( '2018-02-28', '2018-01-31', '2017-12-29', '2017-11-30', '2017-10-31', '2017-09-29', '2017-08-31', '2017-07-31' ) and a.book in ('AFSC2') and a.ccc_taps_company in ('6635') GROUP BY a.COB_DATE, a.POSITION_ID ) a group by a.COB_DATE UNION ALL SELECT a.cob_date, 0 AS CREDIT_CORP_SECTOR_USD_PV01SPRD, 0 AS CREDIT_CORP_SECTOR_USD_PV10_BENCH, 0 AS CREDIT_CORP_ISSUER_USD_PV01SPRD, max(abs(A.USD_PV10_BENCH)) AS CREDIT_CORP_ISSUER_USD_PV10_BENCH, 0 AS CREDIT_CMBS_ISSUER_USD_EXPOSURE, 0 AS CREDIT_CLO_ISSUER_USD_EXPOSURE, 0 AS CREDIT_AUTO_ISSUER_USD_EXPOSURE FROM ( SELECT a.COB_DATE, a.POSITION_ID, Sum(COALESCE(USD_PV10_BENCH ::numeric(15,5), 0)) as USD_PV10_BENCH from cdwuser.U_DM_WM_POSITION A where a.cob_date in ( '2018-02-28', '2018-01-31', '2017-12-29', '2017-11-30', '2017-10-31', '2017-09-29', '2017-08-31', '2017-07-31' ) and a.book in ('AFSC2') and a.ccc_taps_company in ('6635') GROUP BY a.COB_DATE, a.POSITION_ID ) a group by a.COB_DATE /*CREDIT CMBS ISSUER*/ UNION ALL SELECT a.cob_date, 0 AS CREDIT_CORP_SECTOR_USD_PV01SPRD, 0 AS CREDIT_CORP_SECTOR_USD_PV10_BENCH, 0 AS CREDIT_CORP_ISSUER_USD_PV01SPRD, 0 AS CREDIT_CORP_ISSUER_USD_PV10_BENCH, max(abs(A.USD_EXPOSURE)) AS CREDIT_CMBS_ISSUER_USD_EXPOSURE, 0 AS CREDIT_CLO_ISSUER_USD_EXPOSURE, 0 AS CREDIT_AUTO_ISSUER_USD_EXPOSURE FROM ( SELECT a.COB_DATE, a.POSITION_ID, sum(COALESCE(USD_EXPOSURE ::numeric(15,5), 0)) as USD_EXPOSURE from cdwuser.U_DM_WM_POSITION A where a.cob_date in ( '2018-02-28', '2018-01-31', '2017-12-29', '2017-11-30', '2017-10-31', '2017-09-29', '2017-08-31', '2017-07-31' ) and a.book in ('PBCMB') and a.ccc_taps_company in ('6635') GROUP BY a.COB_DATE, a.POSITION_ID ) a group by a.COB_DATE /*CREDIT CLO ISSUER*/ UNION ALL SELECT a.cob_date, 0 AS CREDIT_CORP_SECTOR_USD_PV01SPRD, 0 AS CREDIT_CORP_SECTOR_USD_PV10_BENCH, 0 AS CREDIT_CORP_ISSUER_USD_PV01SPRD, 0 AS CREDIT_CORP_ISSUER_USD_PV10_BENCH, 0 AS CREDIT_CMBS_ISSUER_USD_EXPOSURE, max(abs(A.USD_EXPOSURE)) AS CREDIT_CLO_ISSUER_USD_EXPOSURE, 0 AS CREDIT_AUTO_ISSUER_USD_EXPOSURE FROM ( SELECT a.COB_DATE, a.POSITION_ID, sum(COALESCE(USD_EXPOSURE ::numeric(15,5), 0)) as USD_EXPOSURE from cdwuser.U_DM_WM_POSITION A where a.cob_date in ( '2018-02-28', '2018-01-31', '2017-12-29', '2017-11-30', '2017-10-31', '2017-09-29', '2017-08-31', '2017-07-31' ) and a.book in ('PBCLO') and a.ccc_taps_company in ('6635') GROUP BY a.COB_DATE, a.POSITION_ID ) a group by a.COB_DATE /*CREDIT AUTO ISSUER*/ UNION ALL SELECT a.cob_date, 0 AS CREDIT_CORP_SECTOR_USD_PV01SPRD, 0 AS CREDIT_CORP_SECTOR_USD_PV10_BENCH, 0 AS CREDIT_CORP_ISSUER_USD_PV01SPRD, 0 AS CREDIT_CORP_ISSUER_USD_PV10_BENCH, 0 AS CREDIT_CMBS_ISSUER_USD_EXPOSURE, 0 AS CREDIT_CLO_ISSUER_USD_EXPOSURE, max(abs(A.USD_EXPOSURE)) AS CREDIT_AUTO_ISSUER_USD_EXPOSURE FROM ( SELECT a.COB_DATE, a.POSITION_ID, sum(COALESCE(USD_EXPOSURE ::numeric(15,5), 0)) as USD_EXPOSURE from cdwuser.U_DM_WM_POSITION A where a.cob_date in ( '2018-02-28', '2018-01-31', '2017-12-29', '2017-11-30', '2017-10-31', '2017-09-29', '2017-08-31', '2017-07-31' ) and a.book in ('PBCAR') and a.ccc_taps_company in ('6635') GROUP BY a.COB_DATE, a.POSITION_ID ) a group by a.COB_DATE