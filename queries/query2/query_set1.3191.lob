SELECT RANK() OVER (ORDER BY (abs(sum(a.USD_EQ_DELTA_DECOMP))) desc) as Rank, CASE WHEN a.PRODUCT_DESCRIPTION_DECOMP IS NULL THEN 'UNDEFINED' ELSE a.PRODUCT_DESCRIPTION_DECOMP END PRODUCT_DESCRIPTION_DECOMP, sum(a.USD_EQ_DELTA_DECOMP) as USD_EQ_DELTA_DECOMP FROM CDWUSER.U_DECOMP_MSR a WHERE a.COB_DATE = '2018-02-28' AND a.CCC_DIVISION = 'INSTITUTIONAL EQUITY DIVISION' AND a.CCC_BANKING_TRADING ='TRADING' AND a.LE_GROUP = 'UK' AND ABS(a.USD_EQ_DELTA_DECOMP) > 0 GROUP BY a.PRODUCT_DESCRIPTION_DECOMP ORDER BY ABS(sum(a.USD_EQ_DELTA_DECOMP)) DESC FETCH FIRST 10 ROWS ONLY