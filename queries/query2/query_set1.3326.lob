SELECT a.cob_date, a.curve_name, a.CURRENCY_NM_OF_POSITION, a.CURVE_CURRENCY, case when a.CURVE_NAME like 'fx%' THEN 'FX Basis'  else 'IR Basis' end as Basis_Bucket, CASE  WHEN A.TERM_OF_MEASURE / 365 < 3         THEN '0-3yr' WHEN A.TERM_OF_MEASURE / 365 >= 3         AND A.TERM_OF_MEASURE / 365 < 7         THEN '3-7yr' WHEN A.TERM_OF_MEASURE / 365 >= 7         AND A.TERM_OF_MEASURE / 365 < 12         THEN '7-12yr' WHEN A.TERM_OF_MEASURE / 365 >= 12         AND A.TERM_OF_MEASURE / 365 < 20         THEN '12-20yr' WHEN A.TERM_OF_MEASURE / 365 >= 20         THEN '20yr+' ELSE 'other' END AS TERM, SUM(usd_irpv01sprd) AS usd_irpv01sprd FROM cdwuser.U_EXP_MSR a Where      a.COB_DATE IN ('2018-02-28','2018-02-27') and a.CCC_TAPS_COMPANY in ('8890','8840')  GROUP BY  a.cob_date, a.curve_name,  a.CURRENCY_NM_OF_POSITION, a.CURVE_CURRENCY, case when a.CURVE_NAME like 'fx%' THEN 'FX Basis'  else 'IR Basis' end, CASE  WHEN A.TERM_OF_MEASURE / 365 < 3         THEN '0-3yr' WHEN A.TERM_OF_MEASURE / 365 >= 3         AND A.TERM_OF_MEASURE / 365 < 7         THEN '3-7yr' WHEN A.TERM_OF_MEASURE / 365 >= 7         AND A.TERM_OF_MEASURE / 365 < 12         THEN '7-12yr' WHEN A.TERM_OF_MEASURE / 365 >= 12         AND A.TERM_OF_MEASURE / 365 < 20         THEN '12-20yr' WHEN A.TERM_OF_MEASURE / 365 >= 20         THEN '20yr+' ELSE 'other' END