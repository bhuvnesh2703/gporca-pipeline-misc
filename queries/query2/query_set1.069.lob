SELECT     a.COB_DATE,     CASE         WHEN (a.BASE_CCY = 'JPY' AND A.CURRENCY_OF_RISK_CCY1 = 'UNDEFINED' AND A.CURRENCY_PAIR LIKE '%JPY%') THEN A.BASE_CCY         WHEN (a.BASE_CCY = 'EUR' AND a.CURRENCY_PAIR = 'EURCHF') THEN 'EUR'     ELSE A.RISK_CURRENCY_COMBINED END AS RISK_CURRENCY_COMBINED,     CASE         WHEN (SUBSTR (CURRENCY_PAIR,1,3) IN ('USD', 'UBD', 'UB1') OR SUBSTR (CURRENCY_PAIR,4,3) IN ('USD', 'UBD', 'UB1')) THEN 'USD'         WHEN (SUBSTR (CURRENCY_PAIR,1,3) IN ('EUR') OR SUBSTR (CURRENCY_PAIR,4,3) IN ('EUR')) THEN 'EUR'         WHEN (a.BASE_CCY = 'EUR' AND a.CURRENCY_PAIR = 'EURCHF') THEN 'CHF'     ELSE 'others' END AS PAIR,     SUM (COALESCE (a.SLIDE_FXOPTVAR_MIN_20PCT_USD,0)) AS neg20,     SUM (COALESCE (a.SLIDE_FXOPTVAR_MIN_10PCT_USD,0)) AS neg10,     SUM (COALESCE (a.SLIDE_FXOPTVAR_MIN_05PCT_USD,0)) AS neg5,     SUM (COALESCE (a.SLIDE_FXOPTVAR_MIN_03PCT_USD,0)) AS neg3,     SUM (COALESCE (a.SLIDE_FXOPTVAR_MIN_01PCT_USD,0)) AS neg1,     SUM (COALESCE (a.SLIDE_FXOPTVAR_MIN_0P5PCT_USD,0)) AS neg05,     SUM (COALESCE (a.SLIDE_FXOPTVAR_PLS_0P5PCT_USD,0)) AS pos05,     SUM (COALESCE (a.SLIDE_FXOPTVAR_PLS_01PCT_USD,0)) AS pos1,     SUM (COALESCE (a.SLIDE_FXOPTVAR_PLS_03PCT_USD,0)) AS pos3,     SUM (COALESCE (a.SLIDE_FXOPTVAR_PLS_05PCT_USD,0)) AS pos5,     SUM (COALESCE (a.SLIDE_FXOPTVAR_PLS_10PCT_USD,0)) AS pos10,     SUM (COALESCE (a.SLIDE_FXOPTVAR_PLS_20PCT_USD,0)) AS pos20 FROM     cdwuser.U_DM_FX a WHERE (a.COB_DATE = '2018-02-28' or a.COB_DATE = '2018-02-27') and     (a.ccc_business_area IN ('FXEM CREDIT TRADING', 'FXEM MACRO TRADING')) AND     (a.book NOT IN ('BASKET', 'BASKET HEDGES', /* 'CNH BASKET' ,*/ 'CEEMEA MULTICCY', 'CORRELATION SWAP', 'CORRELATION SWAP 2', 'CORRELATION SWAP 3', 'CORRELATION SWAP 4','DUAL CURRENCY', 'MULTICCY SPEC')) AND     (a.product_type_code <> 'FXBSKT') AND     (a.VAR_EXCL_FL <> 'Y') AND     ((a.BASE_CCY = 'EUR' AND     a.CURRENCY_PAIR = 'EURCHF') OR     (a.BASE_CCY = 'JPY' OR a.CURRENCY_OF_RISK_CCY1 != 'UNDEFINED')) AND     a.vertical_system LIKE ('FXOPT%') AND     A.PRODUCT_TYPE_CODE = 'FXOPT' GROUP BY     a.COB_DATE,     CASE         WHEN (a.BASE_CCY = 'JPY' AND A.CURRENCY_OF_RISK_CCY1 = 'UNDEFINED' AND A.CURRENCY_PAIR LIKE '%JPY%') THEN A.BASE_CCY         WHEN (a.BASE_CCY = 'EUR' AND a.CURRENCY_PAIR = 'EURCHF') THEN 'EUR'     ELSE A.RISK_CURRENCY_COMBINED END,     CASE         WHEN (SUBSTR (CURRENCY_PAIR,1,3) IN ('USD', 'UBD', 'UB1') OR SUBSTR (CURRENCY_PAIR,4,3) IN ('USD', 'UBD', 'UB1')) THEN 'USD'         WHEN (SUBSTR (CURRENCY_PAIR,1,3) IN ('EUR') OR SUBSTR (CURRENCY_PAIR,4,3) IN ('EUR')) THEN 'EUR'         WHEN (a.BASE_CCY = 'EUR' AND a.CURRENCY_PAIR = 'EURCHF') THEN 'CHF'     ELSE 'others' END