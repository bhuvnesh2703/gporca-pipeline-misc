With x as (select currency_of_measure as currency, case when currency_of_measure like '%AED%' or currency_of_measure like '%CNY%' or currency_of_measure like '%HKD%' or currency_of_measure like '%SAR%' then 1 else 0 end as PEGGEDFLAG , case when currency_of_measure not in ('AED', 'SAR', 'HKD', 'CNY', 'AEDUSD', 'CNYUSD', 'HKDUSD', 'SARUSD') then 1 else 0 end as FLOATFLAG, sum(coalesce(c.usd_fx_kappa,0)) as USD_FX_KAPPA from cdwuser.U_FX_MSR c where c.COB_DATE = '2018-02-28' and CCC_BANKING_TRADING <> 'BANKING' and c.DIVISION = 'IED' group by currency_of_measure, case when currency_of_measure like '%AED%' or currency_of_measure like '%CNY%' or currency_of_measure like '%HKD%' or currency_of_measure like '%SAR%' then 1 else 0 end, case when currency_of_measure not in ('AED', 'SAR', 'HKD', 'CNY', 'AEDUSD', 'CNYUSD', 'HKDUSD', 'SARUSD') then 1 else 0 end ) select 'GROSS' as Type, 'PEGGED' as Population, sum(abs(usd_fx_kappa)) as FX_Vega from (select currency, sum(USD_FX_KAPPA) as USD_FX_KAPPA from x where peggedflag = 1 group by currency) a union all select 'GROSS' as Type, 'FLOATING' as Population, sum(abs(usd_fx_kappa)) as FX_Vega from (select currency, sum(USD_FX_KAPPA) as USD_FX_KAPPA from x where floatflag = 1 group by currency) a union all select 'GROSS' as Type, 'ALL' as Population, sum(abs(USD_FX_Kappa)) as FX_Vega from (select currency, sum(USD_FX_KAPPA) as USD_FX_KAPPA from x group by currency) a Union All select 'NET' as Type, 'SHORT PEGGED' as Population, sum(usd_fx_kappa) FX_Vega from x where peggedflag = 1 and usd_fx_kappa < 0 Union all select 'NET' as Type, 'LONG PEGGED' as Population, sum(usd_fx_kappa) FX_Vega from x where peggedflag = 1 and usd_fx_kappa > 0 union all select 'NET' as Type, 'FLOATING' as Population, sum(USD_FX_KAPPA) as FX_Vega from x where floatflag = 1 union all Select 'NET' as Type, 'ALL' as Population, sum(USD_Fx_Kappa) as FX_Vega from x