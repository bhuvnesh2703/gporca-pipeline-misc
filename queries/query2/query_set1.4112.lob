SELECT case when currency_code in ('USD', 'EUR', 'GBP', 'JPY') then currency_code else 'Other' end as currency, CASE WHEN (product_type_code IN ('GVTBOND', 'GVTBONDIL', 'GOVTBONDOPTIL', 'TRRSWAP', 'GVTFRN') AND sectype2 = 'GOVTS') OR (product_type_code IN ('BONDFUT', 'BONDOPT', 'TRS - GVTBONDIL')) THEN 'Govts' WHEN sectype2 IN (UPPER('Swaps'),UPPER( 'RateFuture')) THEN 'Swaps' ELSE 'Others' END AS sectype_group, CASE WHEN SECTYPE2 NOT IN ('Govts') AND (UPPER(curve_name) LIKE '%_BE' OR UPPER(curve_name) LIKE '%_INF' OR UPPER(curve_name) LIKE '%_R36' OR UPPER(curve_name) LIKE '%REAL%' OR UPPER(curve_name) LIKE '%IPD%' OR UPPER(curve_name) LIKE '%HIP%' OR UPPER(curve_name) LIKE '%HPI%') THEN 'IL_RealCurves' WHEN product_type_code IN ('BERMUDAN_SWAPTION_VA') THEN 'Swaps' WHEN product_type_code LIKE '%RATEFUT%' OR sectype2 = UPPER('RateFuture') THEN 'RateFuture' WHEN product_type_code LIKE '%BONDFUT%' THEN 'BONDFUT' WHEN product_type_code LIKE '%BONDOPT%' THEN 'BONDOPT' WHEN (product_type_code IN ('GVTBOND', 'GVTBONDIL', 'GOVTBONDOPTIL', 'GVTFRN') AND sectype2 = UPPER('Govts')) OR UPPER(curve_name) = UPPER('krwktb') OR product_type_code = 'TRRSWAP' OR product_type_code = 'TRS - GVTBONDIL' THEN 'GVTBOND' WHEN sectype2 IN ('Govts', 'OTHER') THEN product_type_code WHEN sectype2 IN (UPPER('CorpBonds'), UPPER('CorpLoans')) THEN 'Corps' ELSE sectype2 END AS sectype_new, CASE WHEN UPPER(curve_name) LIKE '%_BE' OR UPPER(curve_name) LIKE '%_INF' THEN 'Breakeven' WHEN UPPER(curve_name) LIKE UPPER('%_r36') OR UPPER(curve_name) LIKE UPPER('%real%') OR UPPER(curve_name) LIKE UPPER('%ipd%') OR UPPER(curve_name) LIKE UPPER('%hip%') THEN 'Real' ELSE 'Nominal' END AS curve_type, case when term_new<0.25 then term_new when term_new in ('0.25', '0.5','0.75', '1', '2', '3','5', '7', '8', '10', '12', '15', '20',' 30', '40') then term_new else 0 end as term_new, SUM (case when cob_date = '2018-02-28' then coalesce(USD_IR_PV01_BREAKEVEN, 0) else 0 end) AS usd_IR_PV01_Breakeven_cob, SUM (case when cob_date = '2018-02-28' then coalesce(USD_IR_PV01_BREAKEVEN, 0) else -coalesce(USD_IR_PV01_BREAKEVEN, 0) end) AS usd_IR_PV01_Breakeven_change, SUM (case when cob_date = '2018-02-28' then coalesce(USD_IR_UNIFIED_PV01, 0) else 0 end) AS usd_pv01_cob, SUM (case when cob_date = '2018-02-28' then coalesce(USD_IR_UNIFIED_PV01, 0) else -coalesce(USD_IR_UNIFIED_PV01, 0) end) AS usd_pv01_change FROM CDWUSER.U_EXP_TRENDS a WHERE a.cob_date in ('2018-02-28', '2018-02-27') AND CCC_Division IN ('BANK RESOURCE MANAGEMENT', 'INT RATE CREDIT CURRENCY', 'FIXED INCOME DIVISION') AND CCC_BUSINESS_AREA NOT IN ('CREDIT-CORPORATES', 'SECURITIZED PRODUCTS GRP', 'CREDIT-SECURITIZED PRODS', 'STRUCTURED CREDIT PROD', 'CREDIT DERIVATIVE PROD', 'DSP - CREDIT', 'LENDING', 'DERIVS FUNDING') AND CCC_BUSINESS_AREA NOT LIKE 'MS CVA%' AND CCC_BUSINESS_AREA NOT LIKE 'CPM%' AND VERTICAL_SYSTEM NOT LIKE ('PIPELINE_%') AND (CCC_BUSINESS_AREA IN ('INTEREST RATES', 'LIQUID FLOW RATES', 'STRUCTURED RATES')) AND VAR_EXCL_FL <> 'Y' AND (CCC_PRODUCT_LINE IN ('INFLATION PRODUCTS') OR CCC_STRATEGY like 'INFLATION PRODUCTS%') AND PARENT_LEGAL_ENTITY = '0302(G)' AND ccc_banking_trading = 'TRADING' GROUP BY case when currency_code in ('USD', 'EUR', 'GBP', 'JPY') then currency_code else 'Other' end, CASE WHEN (product_type_code IN ('GVTBOND', 'GVTBONDIL', 'GOVTBONDOPTIL', 'TRRSWAP', 'GVTFRN') AND sectype2 = 'GOVTS') OR (product_type_code IN ('BONDFUT', 'BONDOPT', 'TRS - GVTBONDIL')) THEN 'Govts' WHEN sectype2 IN (UPPER('Swaps'),UPPER( 'RateFuture')) THEN 'Swaps' ELSE 'Others' END, CASE WHEN SECTYPE2 NOT IN ('Govts') AND (UPPER(curve_name) LIKE '%_BE' OR UPPER(curve_name) LIKE '%_INF' OR UPPER(curve_name) LIKE '%_R36' OR UPPER(curve_name) LIKE '%REAL%' OR UPPER(curve_name) LIKE '%IPD%' OR UPPER(curve_name) LIKE '%HIP%' OR UPPER(curve_name) LIKE '%HPI%') THEN 'IL_RealCurves' WHEN product_type_code IN ('BERMUDAN_SWAPTION_VA') THEN 'Swaps' WHEN product_type_code LIKE '%RATEFUT%' OR sectype2 = UPPER('RateFuture') THEN 'RateFuture' WHEN product_type_code LIKE '%BONDFUT%' THEN 'BONDFUT' WHEN product_type_code LIKE '%BONDOPT%' THEN 'BONDOPT' WHEN (product_type_code IN ('GVTBOND', 'GVTBONDIL', 'GOVTBONDOPTIL', 'GVTFRN') AND sectype2 = UPPER('Govts')) OR UPPER(curve_name) = UPPER('krwktb') OR product_type_code = 'TRRSWAP' OR product_type_code = 'TRS - GVTBONDIL' THEN 'GVTBOND' WHEN sectype2 IN ('Govts', 'OTHER') THEN product_type_code WHEN sectype2 IN (UPPER('CorpBonds'), UPPER('CorpLoans')) THEN 'Corps' ELSE sectype2 END, CASE WHEN UPPER(curve_name) LIKE '%_BE' OR UPPER(curve_name) LIKE '%_INF' THEN 'Breakeven' WHEN UPPER(curve_name) LIKE UPPER('%_r36') OR UPPER(curve_name) LIKE UPPER('%real%') OR UPPER(curve_name) LIKE UPPER('%ipd%') OR UPPER(curve_name) LIKE UPPER('%hip%') THEN 'Real' ELSE 'Nominal' END, case when term_new<0.25 then term_new when term_new in ('0.25', '0.5','0.75', '1', '2', '3','5', '7', '8', '10', '12', '15', '20',' 30', '40') then term_new else 0 end