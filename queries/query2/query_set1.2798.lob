With x as ( select f.CURRENCY_OF_MEASURE as currency, sum(coalesce(f.USD_FX,0)) as FX_DELTA, case when currency_of_measure IN('AUD','BRL','CAD','CHF','CNY','EUR','GBP','HKD','INR','JPY','TWD','KRW','USD') then 0 else 1 end as EM_CCY_Flag from cdwuser.U_FX_MSR f where f.COB_DATE = '2018-02-28' and f.DIVISION = 'IED' and f.CCC_BANKING_TRADING = 'TRADING' group by f.CURRENCY_OF_MEASURE, case when currency_of_measure IN('AUD','BRL','CAD','CHF','CNY','EUR','GBP','HKD','INR','JPY','TWD','KRW','USD') then 0 else 1 end ) select 'GrossFxDelta' as Concentration, sum(abs(fx_delta)) as Measure from x Union All select 'TopEMDelta' as Concentration, Top_Delta as Measure from ( Select currency, sum(fx_delta) as Top_Delta from x where em_ccy_flag = 1 group by currency order by abs(sum(fx_delta)) desc fetch first 1 rows only) a