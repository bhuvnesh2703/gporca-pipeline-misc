WITH RAW_DATA AS (     SELECT         a.cob_date,         a.PARTIAL_DECOMP_PRODUCT_DESCRIPTION,         CASE             WHEN a.COB_DATE = '2018-02-28'             THEN a.usd_eq_partial_delta         ELSE 0 END AS CUR_DELTA,         CASE             WHEN a.COB_DATE = '2018-02-28'             THEN a.usd_eq_partial_delta         ELSE (-1)*a.usd_eq_partial_delta END AS DIF_DELTA     FROM     cdwuser.U_EXP_MSR_PARTIAL a     WHERE       CCC_BANKING_TRADING IN ('TRADING') AND (a.COB_DATE = '2018-02-28' or a.COB_DATE = '2018-02-27') and A.CCC_PL_REPORTING_REGION in ('JAPAN') AND          (a.VAR_EXCL_FL <> 'Y') AND         (a.ccc_business_area <> 'INTERNATIONAL WEALTH MGMT') AND         a.CCC_DIVISION = 'INSTITUTIONAL EQUITY DIVISION' AND         a.PARTIAL_DECOMP_SECTOR = 'INDEX' AND         a.usd_eq_partial_delta IS NOT NULL ) SELECT     a.PARTIAL_DECOMP_PRODUCT_DESCRIPTION,     SUM(CUR_DELTA) AS SUM_CUR_DELTA,     SUM(DIF_DELTA) AS SUM_DIF_DELTA,     ABS(SUM(CUR_DELTA)) AS ABS_SUM_CUR_DELTA FROM     RAW_DATA a GROUP BY     a.PARTIAL_DECOMP_PRODUCT_DESCRIPTION ORDER BY     ABS (SUM(CUR_DELTA)) DESC FETCH FIRST 15 ROWS ONLY