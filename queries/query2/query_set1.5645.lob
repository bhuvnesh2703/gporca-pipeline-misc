SELECT cob_date, currency, sum(usd_pv01::numeric(15,5)) as usd_pv01 FROM ( Select cob_date, currency_code as currency, SUM(CASE when vertical_system in ('C1_LN', 'C1_NY', 'FXDDI_MO', 'FXDDI_NY', 'FXDDITD_MO', 'FXDDITD_NY', 'STS_HK', 'STS_LN', 'STS_NY', 'STS_NYD', 'STS_SE', 'STS_TK', 'GWM_NY') then GRID_MEASURE_VALUE else 0 end) as usd_pv01 FROM cdwuser.U_GRID_MSR l where cob_date in ('2018-02-28', '2018-02-21') and ccc_division = 'TREASURY CAPITAL MARKETS' and GRID_MEASURE_NAME = 'USD_PV01' and var_excl_fl <>'Y' and (CURRENCY_REGION_CD = 'ASIA' or currency_code in ('JPY', 'NZD', 'AUD')) group by cob_date, currency_code UNION ALL Select cob_date, currency_of_measure as currency, sum(usd_ir_unified_pv01) as usd_pv01 FROM cdwuser.U_IR_MSR p where cob_date in ('2018-02-28', '2018-02-21') and ccc_division = 'TREASURY CAPITAL MARKETS' and not (vertical_system in ('C1_LN', 'C1_NY', 'FXDDI_MO', 'FXDDI_NY', 'FXDDITD_MO', 'FXDDITD_NY', 'STS_HK', 'STS_LN', 'STS_NY', 'STS_NYD', 'STS_SE', 'STS_TK', 'GWM_NY')) and var_excl_fl <>'Y' and (CURRENCY_REGION_CD = 'ASIA' or currency_of_measure in ('JPY', 'NZD', 'AUD')) group by cob_date, currency_of_measure ) A group by cob_date, currency