SELECT a.ATTRIBUTE1 AS "Asset Class", a.ATTRIBUTE9 AS "Risk Metric", a.ATTRIBUTE10 AS "Unit of Measurement", SUM(a.VALUE1)/1000 AS "Current", coalesce(prior_risk,0) AS "Prior Q", (SUM(a.VALUE1)/1000 - coalesce(prior_risk,0)) AS "Change" from CDWUSER.U_GENERIC_DATA a FULL JOIN (SELECT COB_DATE,ATTRIBUTE1,ATTRIBUTE9, ATTRIBUTE10, SUM(VALUE1)/1000 AS prior_risk from CDWUSER.U_GENERIC_DATA where cob_date IN ('2017-12-29') and analytic_group = 'FDSF' and analytics = 'SENSITIVITIES' group by COB_DATE,ATTRIBUTE1,ATTRIBUTE9,ATTRIBUTE10) b on (a.ATTRIBUTE1=b.ATTRIBUTE1 AND a.ATTRIBUTE9=b.ATTRIBUTE9 AND a.ATTRIBUTE10=b.ATTRIBUTE10) where a.cob_date IN ('2018-02-16') and a.analytic_group = 'FDSF' and a.analytics = 'SENSITIVITIES' group by a.COB_DATE,a.ATTRIBUTE1,a.ATTRIBUTE9,a.ATTRIBUTE10,prior_risk order by abs(SUM(a.VALUE1)/1000 - coalesce(prior_risk,0)) desc fetch first 5 rows only